"use strict";(self.webpackChunkClient=self.webpackChunkClient||[]).push([[827],{5827:(k,m,d)=>{d.r(m),d.d(m,{DashboardServiceModule:()=>L});var p=d(7021),y=d(8040),e=d(9468),o=d(95),u=d(7354),g=d(9229),f=d(4085),v=d(6814),c=d(1311),I=d(923),h=d(4807);function b(n,a){1&n&&e.GkF(0)}function C(n,a){if(1&n&&(e.TgZ(0,"option",22),e._uU(1),e.qZA()),2&n){const r=a.$implicit;e.Q6J("value",r.id),e.xp6(1),e.hij(" ",r.name," ")}}const T=function(){return{standalone:!0}};function Z(n,a){if(1&n){const r=e.EpF();e.TgZ(0,"div",10)(1,"div",11)(2,"label",12),e._uU(3,"Inventory Items"),e.qZA(),e.TgZ(4,"ng-select",23),e.NdJ("search",function(i){e.CHM(r);const s=e.oxw(2);return e.KtG(s.searchItems(i))})("change",function(i){e.CHM(r);const s=e.oxw(2);return e.KtG(s.onItemsSelect(i))})("ngModelChange",function(i){e.CHM(r);const s=e.oxw(2);return e.KtG(s.selectedItems=i)}),e.qZA()()()}if(2&n){const r=e.oxw(2);e.xp6(4),e.Q6J("items",r.inventoryItems)("virtualScroll",!0)("bindLabel","name")("bindValue","id")("compareWith",r.compareInventoryItems)("multiple",!0)("ngModel",r.selectedItems)("ngModelOptions",e.DdM(8,T))}}function x(n,a){if(1&n&&(e.TgZ(0,"div",24)(1,"div",9)(2,"div",10)(3,"label",25),e._uU(4,"Name"),e.qZA(),e._UZ(5,"input",26),e.qZA(),e.TgZ(6,"div",10)(7,"label",25),e._uU(8,"Quantity Needed"),e.qZA(),e._UZ(9,"input",27),e.qZA()()()),2&n){const r=a.index;e.Q6J("formGroupName",r),e.xp6(3),e.MGl("for","itemName",r,""),e.xp6(2),e.MGl("id","itemName",r,""),e.xp6(2),e.MGl("for","quantityNeeded",r,""),e.xp6(2),e.MGl("id","quantityNeeded",r,"")}}function M(n,a){if(1&n&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&n){const r=a.$implicit;e.xp6(1),e.hij(" ",r," ")}}function A(n,a){if(1&n&&(e.TgZ(0,"div",9)(1,"ul",28),e.YNc(2,M,2,1,"li",29),e.qZA()()),2&n){const r=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",r.validationErrors)}}function F(n,a){if(1&n){const r=e.EpF();e.TgZ(0,"form",8),e.NdJ("ngSubmit",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.createServiceForm.valid)}),e.TgZ(1,"div",9)(2,"div",10)(3,"div",11)(4,"label",12),e._uU(5,"Name"),e.qZA(),e._UZ(6,"app-text-input",13),e.qZA()(),e.TgZ(7,"div",10)(8,"div",11)(9,"label",12),e._uU(10,"Total Price"),e.qZA(),e._UZ(11,"app-text-input",14),e.qZA()()(),e.TgZ(12,"div",9)(13,"div",10)(14,"div",11)(15,"label",12),e._uU(16,"Speciality"),e.qZA(),e.TgZ(17,"select",15),e.NdJ("change",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.resetFormInventoryItems())}),e.TgZ(18,"option",16),e._uU(19,"Select speciality"),e.qZA(),e.YNc(20,C,2,2,"option",17),e.qZA()()(),e.YNc(21,Z,5,9,"div",18),e.qZA(),e.TgZ(22,"div",19),e.YNc(23,x,10,5,"div",20),e.qZA(),e.YNc(24,A,3,1,"div",21),e.qZA()}if(2&n){const r=e.oxw();let t;e.Q6J("formGroup",r.createServiceForm),e.xp6(6),e.Q6J("label","Name"),e.xp6(5),e.Q6J("label","Total Price"),e.xp6(9),e.Q6J("ngForOf",r.specialityList),e.xp6(1),e.Q6J("ngIf",null!=(null==(t=r.createServiceForm.get("serviceSpecialityId"))?null:t.value)),e.xp6(2),e.Q6J("ngForOf",r.createServiceForm.controls.selectedInventoryItem.controls),e.xp6(1),e.Q6J("ngIf",r.validationErrors.length>0)}}let _=(()=>{var n;class a{constructor(t,i,s,l){this.fb=t,this.serviceService=i,this.toastr=s,this.invetoryService=l,this.visible=!1,this.visibleChange=new e.vpe,this.serviceCreated=new e.vpe,this.specialityList=[],this.inventoryItems=[],this.selectedItems=[],this.inventoryItemParams={pageNumber:1,pageSize:15,searchTerm:"",specialityId:null},this.validationErrors=[],this.service={id:0,name:"",totalPrice:0,serviceSpecialityId:0}}ngOnInit(){this.intializeForm()}searchItems(t){t.term.trim().length>1&&(this.inventoryItemParams.searchTerm=t.term,this.inventoryItemParams.specialityId=this.createServiceForm.get("serviceSpecialityId")?.value,this.invetoryService.getInventoryItems(this.inventoryItemParams).subscribe(i=>{this.inventoryItems=i.result}))}compareInventoryItems(t,i){return t.id===i.id&&t.name===i.name&&t.inventoryItemSpecialityId===i.inventoryItemSpecialityId}onItemsSelect(t){this.updateSelectedInventoryItems(t)}updateSelectedInventoryItems(t){const i=this.createServiceForm.get("selectedInventoryItem");i.clear(),t.forEach(s=>{i.push(this.fb.group({inventoryItemId:[s.id],itemName:[s.name],quantityNeeded:[null==s.quantityNeeded?1:s.quantityNeeded]}))})}modelToggeled(t){this.visible=t,t||this.resetForm(),this.visibleChange.emit(this.visible)}intializeForm(){this.createServiceForm=this.fb.group({id:[this.service.id,o.kI.required],name:[this.service.name,o.kI.required],totalPrice:[this.service.totalPrice,o.kI.required],serviceSpecialityId:[this.service.serviceSpecialityId,o.kI.required],selectedInventoryItem:this.fb.array([])})}resetFormInventoryItems(){this.createServiceForm.get("selectedInventoryItem").clear(),this.inventoryItems=[],this.inventoryItems=[...this.inventoryItems],this.selectedItems=[]}createUpdateService(){this.mapFormToService(),0==this.service.id?this.createService():this.updateService()}createService(){this.serviceService.createService(this.service).subscribe({next:t=>{this.service=t,this.serviceCreated.emit(this.service),this.resetForm(),this.modelToggeled(!1),this.toastr.success("Service created successfully")},error:t=>{console.error(t)}})}updateService(){this.serviceService.updateService(this.service).subscribe({next:t=>{this.service=t,this.serviceCreated.emit(this.service),this.resetForm(),this.modelToggeled(!1),this.toastr.success("Service updated successfully")},error:t=>{console.error(t)}})}resetForm(){this.intializeForm(),this.service={id:0,name:"",totalPrice:0,serviceSpecialityId:0},this.createServiceForm.reset(),this.inventoryItems=[],this.inventoryItems=[...this.inventoryItems],this.selectedItems=[]}mapFormToService(){this.service={id:null==this.createServiceForm.get("id")?.value?0:this.createServiceForm.get("id")?.value,serviceSpecialityId:this.createServiceForm.get("serviceSpecialityId")?.value,name:this.createServiceForm.get("name")?.value,totalPrice:this.createServiceForm.get("totalPrice")?.value,serviceInventoryItems:this.createServiceForm.get("selectedInventoryItem")?.value}}}return(n=a).\u0275fac=function(t){return new(t||n)(e.Y36(o.qu),e.Y36(u.m),e.Y36(g._W),e.Y36(f.V))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-add-service-modal"]],inputs:{visible:"visible",specialityList:"specialityList"},outputs:{visibleChange:"visibleChange",serviceCreated:"serviceCreated"},decls:15,vars:4,consts:[["id","serviceModal","size","xl","scrollable","",3,"visible","visibleChange"],["serviceModal",""],["cModalTitle",""],["cButtonClose","",3,"cModalToggle"],[4,"ngTemplateOutlet"],["cButton","","color","secondary",3,"cModalToggle"],["cButton","","color","primary",3,"click"],["serviceContent",""],["cForm","","autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],[1,"mb-3"],["cLabel",""],["icon","","formControlName","name",3,"label"],["icon","","formControlName","totalPrice",3,"label"],["name","speciality","aria-label","speciality","cSelect","","formControlName","serviceSpecialityId",3,"change"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["class","col",4,"ngIf"],["formArrayName","selectedInventoryItem"],[3,"formGroupName",4,"ngFor","ngForOf"],["class","row",4,"ngIf"],[3,"value"],[3,"items","virtualScroll","bindLabel","bindValue","compareWith","multiple","ngModel","ngModelOptions","search","change","ngModelChange"],[3,"formGroupName"],[3,"for"],["type","text","formControlName","itemName","readonly","",1,"form-control",3,"id"],["type","number","formControlName","quantityNeeded",1,"form-control",3,"id"],[1,"text-danger"],[4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"c-modal",0,1),e.NdJ("visibleChange",function(l){return i.modelToggeled(l)}),e.TgZ(2,"c-modal-header")(3,"h5",2),e._uU(4,"Service"),e.qZA(),e._UZ(5,"button",3),e.qZA(),e.TgZ(6,"c-modal-body"),e.YNc(7,b,1,0,"ng-container",4),e.qZA(),e.TgZ(8,"c-modal-footer")(9,"button",5),e._uU(10," Close "),e.qZA(),e.TgZ(11,"button",6),e.NdJ("click",function(){return i.createUpdateService()}),e._uU(12,"Save changes"),e.qZA()()(),e.YNc(13,F,25,7,"ng-template",null,7,e.W1O)),2&t){const s=e.MAs(1),l=e.MAs(14);e.Q6J("visible",i.visible),e.xp6(5),e.Q6J("cModalToggle",s.id),e.xp6(2),e.Q6J("ngTemplateOutlet",l),e.xp6(2),e.Q6J("cModalToggle",s.id)}},dependencies:[v.sg,v.O5,v.tP,o._Y,o.YN,o.Kr,o.Fj,o.wV,o.EJ,o.JJ,o.JL,o.On,c.nqR,I.t,c.Hq3,c.PFQ,c.$_X,c.eFW,o.sg,o.u,o.x0,o.CE,c.KF4,c.zS7,c.YI7,c.Rbl,c.vPP,c.Ntb,h.w9]}),a})();var S=d(1272),N=d(5684),J=d(6084);function q(n,a){if(1&n&&(e.TgZ(0,"option",15),e._uU(1),e.qZA()),2&n){const r=a.$implicit;e.Q6J("value",r.id),e.xp6(1),e.hij(" ",r.name," ")}}function P(n,a){if(1&n){const r=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"select",12),e.NdJ("ngModelChange",function(i){e.CHM(r);const s=e.oxw();return e.KtG(s.serviceParams.specialityId=i)})("change",function(){e.CHM(r);const i=e.oxw();return e.KtG(i.getServices())}),e.TgZ(1,"option",13),e._uU(2,"Speciality"),e.qZA(),e.YNc(3,q,2,2,"option",14),e.qZA()}if(2&n){const r=e.oxw();e.Q6J("ngModel",r.serviceParams.specialityId),e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",r.specialityList)}}function U(n,a){if(1&n){const r=e.EpF();e.TgZ(0,"tr",19),e.NdJ("click",function(){const s=e.CHM(r).$implicit,l=e.oxw(2);return e.KtG(l.setServiceToUpdate(s))}),e.TgZ(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",20)(8,"button",21),e.NdJ("click",function(i){const l=e.CHM(r).$implicit,w=e.oxw(2);return e.KtG(w.deleteService(l.id,i))}),e.O4$(),e._UZ(9,"svg",22),e.qZA()()()}if(2&n){const r=a.$implicit,t=e.oxw(2);e.xp6(2),e.Oqu(r.name),e.xp6(2),e.Oqu(r.totalPrice),e.xp6(2),e.Oqu(t.getSpecialityNameById(r.serviceSpecialityId))}}function D(n,a){if(1&n&&(e.TgZ(0,"table",16)(1,"thead")(2,"tr")(3,"th",17),e._uU(4,"Service Name"),e.qZA(),e.TgZ(5,"th",17),e._uU(6,"Total Price"),e.qZA(),e.TgZ(7,"th",17),e._uU(8,"Disposables Price"),e.qZA(),e.TgZ(9,"th",17),e._uU(10,"Service"),e.qZA(),e._UZ(11,"th",17),e.qZA()(),e.TgZ(12,"tbody"),e.YNc(13,U,10,3,"tr",18),e.qZA()()),2&n){const r=e.oxw();e.xp6(13),e.Q6J("ngForOf",r.services)}}function Q(n,a){if(1&n){const r=e.EpF();e.TgZ(0,"div",23)(1,"app-pagination",24),e.NdJ("ngModelChange",function(i){e.CHM(r);const s=e.oxw();return e.KtG(s.pagination.currentPage=i)})("pageChanged",function(i){e.CHM(r);const s=e.oxw();return e.KtG(s.pageChanged(i))}),e.qZA()()}if(2&n){const r=e.oxw();e.xp6(1),e.Q6J("boundaryLinks",!0)("totalItems",r.pagination.totalItems)("itemsPerPage",r.pagination.itemsPerPage)("ngModel",r.pagination.currentPage)}}const O=[{path:"",component:(()=>{var n;class a{constructor(t,i,s,l){this.iconSetService=t,this.serviceService=i,this.specialityService=s,this.toastr=l,this.services=[],this.serviceParams={pageNumber:1,pageSize:15,searchTerm:"",specialityId:null},this.pagination=null,this.specialityList=[],this.modalVisibility=!1,t.icons={...y.y}}ngOnInit(){this.getServices(),this.getSpecialities()}getServices(){this.serviceService.getServices(this.serviceParams).subscribe(t=>{this.services=t.result,this.pagination=t.pagination})}getSpecialities(){this.specialityService.getSpecialities().subscribe(t=>{this.specialityList=t})}pageChanged(t){this.serviceParams.pageNumber=t,this.getServices()}resetFilters(){this.serviceParams=this.serviceService.resetServiceParams(),this.getServices()}deleteService(t,i){i.stopPropagation(),this.serviceService.deleteService(t).subscribe({next:s=>{this.services=this.services?.filter(l=>l.id!==t),this.toastr.success("Service deleted successfully")},error:s=>{console.error(s)}})}openModal(){this.modalVisibility=!this.modalVisibility}setServiceToUpdate(t){this.setServiceInventoryItems(t),this.addServiceModal.service=t,this.addServiceModal.intializeForm(),this.openModal()}mapServiceInventoryItemToInventoryItem(t){return t.map(i=>({id:i.inventoryItem?.id||0,name:i.inventoryItem?.name||"",inventoryItemSpecialityId:i.inventoryItem?.inventoryItemSpecialityId||0,quantityNeeded:i.quantityNeeded||1}))}setServiceInventoryItems(t){return this.serviceService.getServiceInventoryItems(t.id).subscribe(i=>{t.serviceInventoryItems=i;const s=this.mapServiceInventoryItemToInventoryItem(t.serviceInventoryItems);this.addServiceModal.selectedItems=s,this.addServiceModal.inventoryItems=s,this.addServiceModal.updateSelectedInventoryItems(s)})}getSpecialityNameById(t){const i=this.specialityList.find(s=>s.id===t);return i?i.name:""}onServiceCreated(t){if(t){const i=this.services.findIndex(s=>s.id===t.id);-1!==i?this.services[i]=t:this.services.push(t)}}}return(n=a).\u0275fac=function(t){return new(t||n)(e.Y36(S.uk),e.Y36(u.m),e.Y36(N.d),e.Y36(g._W))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dashboard-services"]],viewQuery:function(t,i){if(1&t&&e.Gf(_,5),2&t){let s;e.iGM(s=e.CRH())&&(i.addServiceModal=s.first)}},decls:16,vars:6,consts:[["colorScheme","dark","expand","lg",1,"bg-dark"],["navbar","",1,"d-flex","flex-column","gap-2","flex-lg-row","justify-content-between","w-100","px-5"],["cButton","","color","light",3,"click"],[1,""],["cIcon","","name","cilPlus",1,"border","rounded","border-dark"],["name","speciality","class","w-25","aria-label","speciality","cSelect","",3,"ngModel","ngModelChange","change",4,"ngIf"],["cForm","","role","search",1,"d-flex",3,"submit"],["cFormControl","","type","search","placeholder","Search","name","searchTerm","aria-label","Search",1,"me-2",3,"ngModel","ngModelChange"],["cButton","","color","light","variant","outline","type","submit"],["cTable","",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],[3,"visible","specialityList","serviceCreated","visibleChange"],["name","speciality","aria-label","speciality","cSelect","",1,"w-25",3,"ngModel","ngModelChange","change"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["cTable",""],["scope","col"],["class","user-table",3,"click",4,"ngFor","ngForOf"],[1,"user-table",3,"click"],[1,"pt-1"],["cButton","","color","danger",1,"btn-m",3,"click"],["cIcon","","name","cil-trash"],[1,"d-flex","justify-content-center"],[3,"boundaryLinks","totalItems","itemsPerPage","ngModel","ngModelChange","pageChanged"]],template:function(t,i){1&t&&(e.TgZ(0,"c-navbar",0)(1,"div",1)(2,"button",2),e.NdJ("click",function(){return i.openModal()}),e.TgZ(3,"span",3),e.O4$(),e._UZ(4,"svg",4),e._uU(5," Add new service"),e.qZA()(),e.YNc(6,P,4,3,"select",5),e.kcU(),e.TgZ(7,"form",6),e.NdJ("submit",function(){return i.getServices()}),e.TgZ(8,"input",7),e.NdJ("ngModelChange",function(l){return i.serviceParams.searchTerm=l}),e.qZA(),e.TgZ(9,"button",8),e._uU(10,"Search"),e.qZA()(),e.TgZ(11,"button",2),e.NdJ("click",function(){return i.resetFilters()}),e._uU(12,"Reset Filters"),e.qZA()()(),e.YNc(13,D,14,1,"table",9),e.YNc(14,Q,2,4,"div",10),e.TgZ(15,"app-add-service-modal",11),e.NdJ("serviceCreated",function(l){return i.onServiceCreated(l)})("visibleChange",function(l){return i.modalVisibility=l}),e.qZA()),2&t&&(e.xp6(6),e.Q6J("ngIf",i.specialityList),e.xp6(2),e.Q6J("ngModel",i.serviceParams.searchTerm),e.xp6(5),e.Q6J("ngIf",i.services&&i.services.length>0),e.xp6(1),e.Q6J("ngIf",i.pagination),e.xp6(1),e.Q6J("visible",i.modalVisibility)("specialityList",i.specialityList))},dependencies:[c.auY,c.SB8,v.sg,v.O5,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.On,o.F,c.nqR,S.ar,c.Hq3,c.$_X,c.oHf,J.Q,_]}),a})(),data:{title:"Services"}}];let Y=(()=>{var n;class a{}return(n=a).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[p.Bz.forChild(O),p.Bz]}),a})();var G=d(6319);let L=(()=>{var n;class a{}return(n=a).\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[Y,c.U$I,c.W4s,c.e$z,v.ez,c.u3b,o.u5,G.c,c.m81,c.zkK,h.A0]}),a})()}}]);