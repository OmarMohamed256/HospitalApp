"use strict";(self.webpackChunkClient=self.webpackChunkClient||[]).push([[620],{3934:(w,y,p)=>{p.d(y,{K:()=>T});var u=p(7490),v=p(5516),a=p(4726),I=p(2096),A=p(7398),S=p(9468),C=p(9862);let T=(()=>{var e;class Z{constructor(m){this.http=m,this.baseUrl=v.N.apiUrl,this.userParams=new u.M({pageNumber:1,pageSize:15}),this.memberCache=new Map}resetUserParams(){return this.userParams=new u.M,this.userParams}getUserData(m){const h=Object.values(m).join("-"),b=this.memberCache.get(h);if(b)return(0,I.of)(b);let f=(0,a.r)(m.pageNumber,m.pageSize);return f=f.append("orderBy",m.orderBy),f=f.append("order",m.order),""!==m.searchTerm.trim()&&(f=f.append("searchTerm",m.searchTerm.trim())),""!==m.gender.trim()&&(f=f.append("gender",m.gender.trim())),null!==m.doctorSpecialityId&&(f=f.append("doctorSpecialityId",m.doctorSpecialityId)),""!==m.roleName.trim()&&(f=f.append("roleName",m.roleName.trim())),(0,a.T)(this.baseUrl+"user/all/",f,this.http).pipe((0,A.U)(M=>(this.memberCache.set(h,M),M)))}getUsers(m){return this.getUserData(m)}getUser(m){const h=[...this.memberCache.values()].reduce((b,f)=>b.concat(f.result),[]).find(b=>b.id==m);return h?(0,I.of)(h):this.http.get(this.baseUrl+"user/"+m)}setUserParams(m){this.userParams=m}updateUser(m){return this.http.put(this.baseUrl+"user/",m)}uploadImage(m){const h=new FormData;h.append("file",m.file),h.append("userId",m.userId.toString()),h.append("category",m.category);let b=new Date(m.imageDate);return h.append("imageDate",b.toISOString()),h.append("type",m.type),h.append("organ",m.organ),this.http.post(this.baseUrl+"user/uploadImage",h)}getUserImages(m){return this.http.get(this.baseUrl+"user/userImages/"+m)}invalidateUsersCache(){this.memberCache.clear()}}return(e=Z).\u0275fac=function(m){return new(m||e)(S.LFG(C.eN))},e.\u0275prov=S.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),Z})()},2620:(w,y,p)=>{p.r(y),p.d(y,{DashboardAppointmentModule:()=>ct});var u=p(1311),v=p(6814),a=p(95),I=p(6319),A=p(7021),S=p(5273),C=p(8180),T=p(3348),e=p(9468),Z=p(4541),x=p(5684),m=p(4243),h=p(1272),b=p(6084);function f(o,s){if(1&o&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.hij(" ",n.name," ")}}function N(o,s){if(1&o){const n=e.EpF();e.O4$(),e.kcU(),e.TgZ(0,"select",11),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.appointmentParams.specialityId=i)})("change",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.getAppointments())}),e.TgZ(1,"option",12),e._uU(2,"Speciality"),e.qZA(),e.YNc(3,f,2,2,"option",13),e.qZA()}if(2&o){const n=e.oxw();e.Q6J("ngModel",n.appointmentParams.specialityId),e.xp6(1),e.Q6J("value",null),e.xp6(2),e.Q6J("ngForOf",n.specialityList)}}function M(o,s){if(1&o&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.value),e.xp6(1),e.hij(" ",n.display," ")}}function W(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"select",15),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.appointmentParams.type=i)})("change",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.getAppointments())}),e.TgZ(1,"option",12),e._uU(2,"Type"),e.qZA(),e.YNc(3,M,2,2,"option",13),e.qZA()}if(2&o){const n=e.oxw();e.Q6J("ngModel",n.appointmentParams.type),e.xp6(1),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",n.typeList)}}function j(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(i){e.CHM(n);const r=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.navigateToAppointment(r,i))}),e._uU(1),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ","Invoiced"===n.status?"View Invoice":"Booked"===n.status?"Medical Operations":"Finalized"===n.status?"Invoice":""," ")}}function X(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(i){e.CHM(n);const r=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.navigateToAppointment(r,i))}),e._uU(1),e.qZA()}if(2&o){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ","Invoiced"===n.status?"View Invoice":"Booked"===n.status||"Finalized"===n.status?"Medical Operations":""," ")}}function ee(o,s){if(1&o&&(e.TgZ(0,"tr",21)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.ALo(16,"date"),e.qZA(),e.TgZ(17,"td",22),e.YNc(18,j,2,1,"button",23),e.YNc(19,X,2,1,"button",23),e.qZA()()),2&o){const n=s.$implicit,t=e.oxw(2);e.MGl("routerLink","update/",n.id,""),e.xp6(2),e.Oqu(null==n.doctor?null:n.doctor.fullName),e.xp6(2),e.Oqu(null==n.patient?null:n.patient.fullName),e.xp6(2),e.Oqu(t.getSpecialityNameById(n.appointmentSpecialityId)),e.xp6(2),e.Oqu(n.status),e.xp6(2),e.Oqu(n.type),e.xp6(2),e.Oqu(e.xi3(13,10,n.dateCreated,"short")),e.xp6(3),e.Oqu(e.xi3(16,13,n.dateOfVisit,"short")),e.xp6(3),e.Q6J("ngIf",t.isReceptionist()),e.xp6(1),e.Q6J("ngIf",t.isDoctor())}}const J=function(){return{cursor:"pointer"}};function te(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"table",16)(1,"thead")(2,"tr")(3,"th",17),e._uU(4,"Doctor Name"),e.qZA(),e.TgZ(5,"th",17),e._uU(6,"Patient Name"),e.qZA(),e.TgZ(7,"th",17),e._uU(8,"Speciality"),e.qZA(),e.TgZ(9,"th",17),e._uU(10,"Status"),e.qZA(),e.TgZ(11,"th",17),e._uU(12,"Type"),e.qZA(),e.TgZ(13,"th",18),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.toggleOrder("dateCreated"))}),e._uU(14," Date Created "),e.O4$(),e._UZ(15,"svg",19),e.qZA(),e.kcU(),e.TgZ(16,"th",18),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.toggleOrder("dateOfVisit"))}),e._uU(17," Date Of Visit "),e.O4$(),e._UZ(18,"svg",19),e.qZA(),e.kcU(),e._UZ(19,"th",17),e.qZA()(),e.TgZ(20,"tbody"),e.YNc(21,ee,20,16,"tr",20),e.qZA()()}if(2&o){const n=e.oxw();e.xp6(13),e.Q6J("ngStyle",e.DdM(5,J)),e.xp6(2),e.Q6J("name","dateCreated"===n.appointmentParams.orderBy&&"desc"===n.appointmentParams.order?"cil-arrow-bottom":"cil-arrow-top"),e.xp6(1),e.Q6J("ngStyle",e.DdM(6,J)),e.xp6(2),e.Q6J("name","dateOfVisit"===n.appointmentParams.orderBy&&"desc"===n.appointmentParams.order?"cil-arrow-bottom":"cil-arrow-top"),e.xp6(3),e.Q6J("ngForOf",n.appointments)}}function ie(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",25)(1,"app-pagination",26),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.pagination.currentPage=i)})("pageChanged",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.pageChanged(i))}),e.qZA()()}if(2&o){const n=e.oxw();e.xp6(1),e.Q6J("boundaryLinks",!0)("totalItems",n.pagination.totalItems)("itemsPerPage",n.pagination.itemsPerPage)("ngModel",n.pagination.currentPage)}}let ne=(()=>{var o;class s{constructor(t,i,r,c){this.appointmentService=t,this.specialityService=i,this.router=r,this.accountService=c,this.appointments=[],this.appointmentParams={pageNumber:1,pageSize:15,orderBy:"dateCreated",order:"desc",type:"",specialityId:null},this.pagination=null,this.specialityList=[],this.typeList=S.f}ngOnInit(){this.accountService.currentUser$.pipe((0,C.q)(1)).subscribe(t=>this.currentUser=t),this.getAppointments(),this.getSpecialities()}getAppointments(){this.currentUser?.roles.includes(T.K.DOCTOR)?this.appointmentService.getAppointmentsByDoctorId(this.appointmentParams,this.currentUser.id.toString()).subscribe(t=>{this.appointments=t.result,this.pagination=t.pagination,console.log(t)}):this.appointmentService.getAppointments(this.appointmentParams).subscribe(t=>{this.appointments=t.result,this.pagination=t.pagination})}pageChanged(t){this.appointmentParams.pageNumber=t,this.getAppointments()}getSpecialities(){this.specialityService.getSpecialities().subscribe(t=>{this.specialityList=t})}getSpecialityNameById(t){const i=this.specialityList.find(r=>r.id===t);return i?i.name:""}toggleOrder(t){this.appointmentParams.orderBy===t?this.appointmentParams.order="asc"===this.appointmentParams.order?"desc":"asc":(this.appointmentParams.orderBy=t,this.appointmentParams.order="desc"),this.getAppointments()}resetFilters(){this.appointmentParams=this.appointmentService.resetParams(),this.getAppointments()}navigateToAppointment(t,i){i.stopPropagation(),"Invoiced"===t.status?this.router.navigate(["appointments/view-invoice",t.invoiceId]):"Booked"===t.status?this.router.navigate(["appointments/medical-operations",t.id]):"Finalized"===t.status&&this.router.navigate(["appointments/finalize",t.invoiceId])}isDoctor(){return this.currentUser?.roles.includes(T.K.DOCTOR)}isReceptionist(){return this.currentUser?.roles.some(t=>t===T.K.ADMIN||t===T.K.RECEPTIONIST)}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(Z.H),e.Y36(x.d),e.Y36(A.F0),e.Y36(m.B))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-dashboard-appointments"]],decls:13,vars:5,consts:[["colorScheme","dark","expand","lg",1,"bg-dark"],["navbar","",1,"d-flex","flex-column","gap-2","flex-lg-row","justify-content-between","w-100","px-5"],["cButton","","color","light","routerLink","/appointments/add"],[1,""],["cIcon","","name","cilPlus",1,"border","rounded","border-dark"],["name","speciality","class","w-25","aria-label","speciality","cSelect","",3,"ngModel","ngModelChange","change",4,"ngIf"],["type","date",1,"form-control",3,"ngModel","change","ngModelChange"],["name","type","class","w-25","aria-label","type","cSelect","",3,"ngModel","ngModelChange","change",4,"ngIf"],["cButton","","color","light",3,"click"],["cTable","",4,"ngIf"],["class","d-flex justify-content-center",4,"ngIf"],["name","speciality","aria-label","speciality","cSelect","",1,"w-25",3,"ngModel","ngModelChange","change"],["disabled","",3,"value"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","type","aria-label","type","cSelect","",1,"w-25",3,"ngModel","ngModelChange","change"],["cTable",""],["scope","col"],["scope","col",1,"arrow-filter",3,"ngStyle","click"],["cIcon","",3,"name"],["class","user-table",3,"routerLink",4,"ngFor","ngForOf"],[1,"user-table",3,"routerLink"],[1,"pt-1"],["cButton","","color","success","class","btn-m",3,"click",4,"ngIf"],["cButton","","color","success",1,"btn-m",3,"click"],[1,"d-flex","justify-content-center"],[3,"boundaryLinks","totalItems","itemsPerPage","ngModel","ngModelChange","pageChanged"]],template:function(t,i){1&t&&(e.TgZ(0,"c-navbar",0)(1,"div",1)(2,"button",2)(3,"span",3),e.O4$(),e._UZ(4,"svg",4),e._uU(5," Add new appointment"),e.qZA()(),e.YNc(6,N,4,3,"select",5),e.kcU(),e.TgZ(7,"input",6),e.NdJ("change",function(){return i.getAppointments()})("ngModelChange",function(c){return i.appointmentParams.appointmentDateOfVisit=c}),e.qZA(),e.YNc(8,W,4,3,"select",7),e.TgZ(9,"button",8),e.NdJ("click",function(){return i.resetFilters()}),e._uU(10,"Reset Filters"),e.qZA()()(),e.YNc(11,te,22,7,"table",9),e.YNc(12,ie,2,4,"div",10)),2&t&&(e.xp6(6),e.Q6J("ngIf",i.specialityList),e.xp6(1),e.Q6J("ngModel",i.appointmentParams.appointmentDateOfVisit),e.xp6(1),e.Q6J("ngIf",i.typeList),e.xp6(3),e.Q6J("ngIf",i.appointments),e.xp6(1),e.Q6J("ngIf",i.pagination))},dependencies:[A.rH,u.auY,u.SB8,v.sg,v.O5,v.PC,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.On,u.nqR,h.ar,u.Hq3,b.Q,v.uU]}),s})();var k=p(5861),oe=p(6973),re=p(305);function U(o,s){const n="object"==typeof s;return new Promise((t,i)=>{const r=new re.Hp({next:c=>{t(c),r.unsubscribe()},error:i,complete:()=>{n?t(s.defaultValue):i(new oe.K)}});o.subscribe(r)})}var q=p(7490),Q=p(3934),L=p(5719),O=p(9229),D=p(4807);function ae(o,s){if(1&o&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.value),e.xp6(1),e.hij(" ",n.display," ")}}function se(o,s){if(1&o&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.hij(" ",n.name," ")}}function ce(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",2)(1,"div",3)(2,"label",4),e._uU(3,"Doctor"),e.qZA(),e.TgZ(4,"ng-select",9),e.NdJ("search",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.searchDoctors(i))})("change",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onDoctorSelect(i))}),e.qZA()()()}if(2&o){const n=e.oxw();e.xp6(4),e.Q6J("items",n.doctorList)("virtualScroll",!0)("bindLabel","fullName")}}function le(o,s){if(1&o&&(e.TgZ(0,"option",14),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(n)}}function pe(o,s){if(1&o&&(e.TgZ(0,"option",14),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(e.xi3(2,2,n,"shortTime"))}}const E=function(){return{standalone:!0}};function me(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"label"),e._uU(4,"Day"),e.qZA(),e.TgZ(5,"select",15),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedDay=i)})("change",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.getDayAvailableTimes())}),e.YNc(6,le,2,2,"option",7),e.qZA()()(),e.TgZ(7,"div",2)(8,"div",3)(9,"label"),e._uU(10,"Time"),e.qZA(),e.TgZ(11,"select",16),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedTime=i)}),e.YNc(12,pe,3,5,"option",7),e.qZA()()()()}if(2&o){const n=e.oxw();e.xp6(5),e.Q6J("ngModel",n.selectedDay)("ngModelOptions",e.DdM(6,E)),e.xp6(1),e.Q6J("ngForOf",n.availableDays),e.xp6(5),e.Q6J("ngModel",n.selectedTime)("ngModelOptions",e.DdM(7,E)),e.xp6(1),e.Q6J("ngForOf",n.availableTimesForSelectedDay)}}function de(o,s){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.xp6(1),e.hij(" ",n," ")}}function ue(o,s){if(1&o&&(e.TgZ(0,"div",1)(1,"ul",17),e.YNc(2,de,2,1,"li",18),e.qZA()()),2&o){const n=e.oxw();e.xp6(2),e.Q6J("ngForOf",n.validationErrors)}}let ve=(()=>{var o;class s{constructor(t,i,r,c,l,d,g,_){this.fb=t,this.specialityService=i,this.userService=r,this.doctorWorkingHoursService=c,this.appointmentService=l,this.datePipe=d,this.toastr=g,this.router=_,this.validationErrors=[],this.typeList=S.f,this.specialityList=[],this.patientList=[],this.doctorList=[],this.doctorWorkingHours=[],this.doctorBookedDates=[],this.availableTimeSlots=[],this.nextSevenDays=[],this.availableDays=[],this.availableTimesForSelectedDay=[],this.rolePatient=T.K.PATIENT,this.roleDoctor=T.K.DOCTOR,this.selectedDay=null,this.selectedTime=null,this.patientParams=new q.M({pageNumber:1,pageSize:5,roleName:this.rolePatient}),this.doctorParams=new q.M({pageNumber:1,pageSize:5,roleName:this.roleDoctor})}ngOnInit(){this.initializeForm(),this.getSpecialities(),this.nextSevenDays=this.generateDays()}initializeForm(){this.CreateAppointmentForm=this.fb.group({type:["",a.kI.required],dateOfVisit:["",a.kI.required],creationNote:[""],doctorId:["",a.kI.required],patientId:["",a.kI.required],appointmentSpecialityId:["",a.kI.required]})}searchPatients(t){t.term.trim().length>2&&(this.patientParams.searchTerm=t.term,this.userService.getUserData(this.patientParams).subscribe(i=>{this.patientList=i.result}))}searchDoctors(t){t.term.trim().length>2&&(this.doctorParams.searchTerm=t.term,this.doctorParams.doctorSpecialityId=this.CreateAppointmentForm.get("appointmentSpecialityId")?.value,this.userService.getUserData(this.doctorParams).subscribe(i=>{this.doctorList=i.result}))}getSpecialities(){this.specialityService.getSpecialities().subscribe(t=>{this.specialityList=t})}onPatientSelect(t){this.CreateAppointmentForm.get("patientId")?.setValue(t.id)}resetDateTime(){this.selectedDay=null,this.selectedTime=null,this.availableDays=[],this.availableTimesForSelectedDay=[]}onDoctorSelect(t){var i=this;return(0,k.Z)(function*(){i.resetDateTime(),i.CreateAppointmentForm.get("doctorId")?.setValue(t.id);const[r,c]=yield Promise.all([U(i.getDoctorWorkingHours(t.id)),U(i.getDoctorUpcomingAppointmentsDates(t.id))]);i.doctorWorkingHours=r,i.doctorBookedDates=c;const l=i.generateTimeSlots(i.nextSevenDays);i.availableTimeSlots=i.generateAvailableTimeSlots(l),i.getAvailableDays()})()}getDoctorWorkingHours(t){return this.doctorWorkingHoursService.getDoctorWorkingHoursByDoctorId(t)}getDoctorUpcomingAppointmentsDates(t){return this.appointmentService.getDoctorUpcomingAppointmentsDates(t)}generateDays(){const t=new Date,i=[];for(let r=0;r<7;r++){const c=new Date(t);c.setDate(t.getDate()+r),i.push(c)}return i}generateTimeSlots(t){const i=[];return t.forEach(r=>{const c=r.getDay(),l=this.doctorWorkingHours.find(d=>d.dayOfWeek===c);if(l){const d=new Date(r.toDateString()+" "+l.startTime),g=new Date(r.toDateString()+" "+l.endTime);for(let _=new Date(d);_<g;_.setMinutes(_.getMinutes()+30))i.push(new Date(_))}}),i}generateAvailableTimeSlots(t){const i=this.doctorBookedDates.map(c=>new Date(c));return t.filter(c=>!i.some(l=>l.getTime()===c.getTime()))}getAvailableDays(){const t=new Set;this.availableTimeSlots.forEach(i=>{t.add(i.toDateString())}),this.availableDays=Array.from(t)}getDayAvailableTimes(){if(this.selectedDay){const t=new Date(this.selectedDay);this.availableTimesForSelectedDay=this.availableTimeSlots.filter(i=>i.toDateString()===t.toDateString())}}selectDayAndTime(){if(this.selectedDay&&this.selectedTime){const t=new Date(this.selectedDay),i=new Date(this.selectedTime);return t.setHours(i.getHours(),i.getMinutes()),this.datePipe.transform(t,"yyyy-MM-ddTHH:mm:ss.SSSSSSS")}return null}submitCreateAppointmentForm(){this.CreateAppointmentForm.get("dateOfVisit")?.setValue(this.selectDayAndTime()),this.CreateAppointmentForm.valid&&this.createAppointment()}createAppointment(){const t=this.mapFormToAppointment();this.appointmentService.createAppointment(t).subscribe({next:i=>{this.toastr.success("Appointment Added Successfully"),this.router.navigateByUrl("/appointments")},error:i=>{this.validationErrors=i}})}mapFormToAppointment(){return{appointmentSpecialityId:this.CreateAppointmentForm.get("appointmentSpecialityId")?.value,dateOfVisit:this.CreateAppointmentForm.get("dateOfVisit")?.value,doctorId:this.CreateAppointmentForm.get("doctorId")?.value,patientId:this.CreateAppointmentForm.get("patientId")?.value,type:this.CreateAppointmentForm.get("type")?.value}}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(a.qu),e.Y36(x.d),e.Y36(Q.K),e.Y36(L.i),e.Y36(Z.H),e.Y36(v.uU),e.Y36(O._W),e.Y36(A.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-add-appointment"]],decls:35,vars:12,consts:[["cForm","","autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],[1,"mb-3"],["cLabel",""],["name","type","aria-label","type","cSelect","",3,"formControl"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","appointmentSpecialityId","cSelect","",3,"formControl"],[3,"items","virtualScroll","bindLabel","search","change"],["class","col",4,"ngIf"],["class","row",4,"ngIf"],["rows","3",1,"form-control",3,"formControl"],["type","submit",1,"btn","btn-primary"],[3,"value"],["cSelect","",3,"ngModel","ngModelOptions","ngModelChange","change"],["cSelect","",3,"ngModel","ngModelOptions","ngModelChange"],[1,"text-danger"],[4,"ngFor","ngForOf"]],template:function(t,i){if(1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return i.submitCreateAppointmentForm()}),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5,"Type"),e.qZA(),e.TgZ(6,"select",5)(7,"option",6),e._uU(8,"Type"),e.qZA(),e.YNc(9,ae,2,2,"option",7),e.qZA()()(),e.TgZ(10,"div",2)(11,"div",3)(12,"label",4),e._uU(13,"Speciality"),e.qZA(),e.TgZ(14,"select",8)(15,"option",6),e._uU(16,"Speciality"),e.qZA(),e.YNc(17,se,2,2,"option",7),e.qZA()()()(),e.TgZ(18,"div",1)(19,"div",2)(20,"div",3)(21,"label",4),e._uU(22,"Patient"),e.qZA(),e.TgZ(23,"ng-select",9),e.NdJ("search",function(c){return i.searchPatients(c)})("change",function(c){return i.onPatientSelect(c)}),e.qZA()()(),e.YNc(24,ce,5,3,"div",10),e.qZA(),e.YNc(25,me,13,8,"div",11),e.TgZ(26,"div",1)(27,"div",2)(28,"div",3)(29,"label",4),e._uU(30,"Note"),e.qZA(),e._UZ(31,"textarea",12),e.qZA()()(),e.YNc(32,ue,3,1,"div",11),e.TgZ(33,"button",13),e._uU(34,"Add Appointment"),e.qZA()()),2&t){let r;e.Q6J("formGroup",i.CreateAppointmentForm),e.xp6(6),e.Q6J("formControl",i.CreateAppointmentForm.controls.type),e.xp6(3),e.Q6J("ngForOf",i.typeList),e.xp6(5),e.Q6J("formControl",i.CreateAppointmentForm.controls.appointmentSpecialityId),e.xp6(3),e.Q6J("ngForOf",i.specialityList),e.xp6(6),e.Q6J("items",i.patientList)("virtualScroll",!0)("bindLabel","fullName"),e.xp6(1),e.Q6J("ngIf",""!=(null==(r=i.CreateAppointmentForm.get("appointmentSpecialityId"))?null:r.value)),e.xp6(1),e.Q6J("ngIf",i.availableTimeSlots.length>0),e.xp6(6),e.Q6J("formControl",i.CreateAppointmentForm.controls.creationNote),e.xp6(1),e.Q6J("ngIf",i.validationErrors.length>0)}},dependencies:[v.sg,v.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.On,u.nqR,u.$_X,u.eFW,a.oH,a.sg,D.w9,v.uU]}),s})();function ge(o,s){if(1&o&&(e.TgZ(0,"option",15),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.value),e.xp6(1),e.hij(" ",n.display," ")}}function _e(o,s){if(1&o&&(e.TgZ(0,"option",15),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.id),e.xp6(1),e.hij(" ",n.name," ")}}function he(o,s){if(1&o&&(e.TgZ(0,"option",15),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(n)}}function fe(o,s){if(1&o&&(e.TgZ(0,"option",15),e._uU(1),e.ALo(2,"date"),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n),e.xp6(1),e.Oqu(e.xi3(2,2,n,"shortTime"))}}const F=function(){return{standalone:!0}};function Ae(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"label"),e._uU(4,"Day"),e.qZA(),e.TgZ(5,"select",16),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedDay=i)})("change",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.getDayAvailableTimes())}),e.TgZ(6,"option",17),e._uU(7,"Select Day"),e.qZA(),e.YNc(8,he,2,2,"option",7),e.qZA()()(),e.TgZ(9,"div",2)(10,"div",3)(11,"label"),e._uU(12,"Time"),e.qZA(),e.TgZ(13,"select",18),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedTime=i)}),e.TgZ(14,"option",17),e._uU(15,"Select Time"),e.qZA(),e.YNc(16,fe,3,5,"option",7),e.qZA()()()()}if(2&o){const n=e.oxw();e.xp6(5),e.Q6J("ngModel",n.selectedDay)("ngModelOptions",e.DdM(6,F)),e.xp6(3),e.Q6J("ngForOf",n.availableDays),e.xp6(5),e.Q6J("ngModel",n.selectedTime)("ngModelOptions",e.DdM(7,F)),e.xp6(3),e.Q6J("ngForOf",n.availableTimesForSelectedDay)}}function Te(o,s){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.xp6(1),e.hij(" ",n," ")}}function be(o,s){if(1&o&&(e.TgZ(0,"div",1)(1,"ul",19),e.YNc(2,Te,2,1,"li",20),e.qZA()()),2&o){const n=e.oxw();e.xp6(2),e.Q6J("ngForOf",n.validationErrors)}}function Ze(o,s){1&o&&(e.TgZ(0,"button",21),e._uU(1,"Update Appointment"),e.qZA())}const ye=function(o){return["/appointments/medical-operations",o]};function Ie(o,s){if(1&o&&(e.TgZ(0,"button",22),e._uU(1,"Enter Medical Operations"),e.qZA()),2&o){const n=e.oxw();e.Q6J("routerLink",e.VKq(1,ye,null==n.appointment?null:n.appointment.id))}}const Se=function(o){return["/appointments/finalize",o]};function Ce(o,s){if(1&o&&(e.TgZ(0,"button",22),e._uU(1,"Enter Medical Operations"),e.qZA()),2&o){const n=e.oxw();e.Q6J("routerLink",e.VKq(1,Se,null==n.appointment?null:n.appointment.invoiceId))}}const xe=function(o){return["/appointments/view-invoice",o]};function De(o,s){if(1&o&&(e.TgZ(0,"button",22),e._uU(1,"View Invoice"),e.qZA()),2&o){const n=e.oxw();e.Q6J("routerLink",e.VKq(1,xe,null==n.appointment?null:n.appointment.invoiceId))}}let Me=(()=>{var o;class s{constructor(t,i,r,c,l,d,g,_){this.fb=t,this.specialityService=i,this.userService=r,this.doctorWorkingHoursService=c,this.appointmentService=l,this.route=d,this.datePipe=g,this.toastr=_,this.validationErrors=[],this.typeList=S.f,this.specialityList=[],this.patientList=[],this.doctorList=[],this.doctorWorkingHours=[],this.doctorBookedDates=[],this.availableTimeSlots=[],this.nextSevenDays=[],this.availableDays=[],this.availableTimesForSelectedDay=[],this.selectedPatient=null,this.selectedDoctor=null,this.rolePatient=T.K.PATIENT,this.roleDoctor=T.K.DOCTOR,this.selectedDay=null,this.selectedTime=null,this.patientParams=new q.M({pageNumber:1,pageSize:5,roleName:this.rolePatient}),this.doctorParams=new q.M({pageNumber:1,pageSize:5,roleName:this.roleDoctor})}ngOnInit(){this.getSpecialities(),this.route.data.subscribe(t=>{this.appointment=t.appointment,this.patientList=[...this.patientList,this.appointment?.patient],this.selectedPatient=this.patientList[0],this.doctorList=[...this.doctorList,this.appointment?.doctor],this.selectedDoctor=this.doctorList[0],this.initializeForm(),this.nextSevenDays=this.generateDays(),this.onDoctorSelect(this.selectedDoctor,!1),this.selectedDay=this.getIntialSelectedDay(),this.selectedTime=this.getIntialSelectedTime()})}getIntialSelectedDay(){return this.appointment?.dateOfVisit?new Date(this.appointment.dateOfVisit).toDateString():null}getIntialSelectedTime(){return this.appointment?.dateOfVisit?new Date(this.appointment.dateOfVisit):null}initializeForm(){this.UpdateAppointmentForm=this.fb.group({id:[this.appointment?.id,a.kI.required],type:[this.appointment?.type,a.kI.required],status:[this.appointment?.status,a.kI.required],dateOfVisit:[this.appointment?.dateOfVisit,a.kI.required],creationNote:[this.appointment?.creationNote],doctorId:[this.appointment?.doctorId,a.kI.required],patientId:[this.appointment?.patientId,a.kI.required],appointmentSpecialityId:[this.appointment?.appointmentSpecialityId,a.kI.required]})}getSpecialities(){this.specialityService.getSpecialities().subscribe(t=>{this.specialityList=t})}searchPatients(t){t.term.trim().length>2&&(this.patientParams.searchTerm=t.term,this.userService.getUserData(this.patientParams).subscribe(i=>{this.patientList=i.result}))}searchDoctors(t){t.term.trim().length>2&&(this.doctorParams.searchTerm=t.term,this.doctorParams.doctorSpecialityId=this.UpdateAppointmentForm.get("appointmentSpecialityId")?.value,this.userService.getUserData(this.doctorParams).subscribe(i=>{this.doctorList=i.result}))}onPatientSelect(t){this.UpdateAppointmentForm.get("patientId")?.setValue(t.id)}resetDateTime(){this.selectedDay=null,this.selectedTime=null,this.availableDays=[],this.availableTimesForSelectedDay=[]}onDoctorSelect(t,i=!0){var r=this;return(0,k.Z)(function*(){i&&r.resetDateTime(),r.UpdateAppointmentForm.get("doctorId")?.setValue(t.id);const[c,l]=yield Promise.all([U(r.getDoctorWorkingHours(t.id)),U(r.getDoctorUpcomingAppointmentsDates(t.id))]);r.doctorWorkingHours=c,r.doctorBookedDates=l.filter(g=>g!==r.appointment?.dateOfVisit);const d=r.generateTimeSlots(r.nextSevenDays);r.availableTimeSlots=r.generateAvailableTimeSlots(d),r.getAvailableDays(),r.getDayAvailableTimes()})()}getDoctorWorkingHours(t){return this.doctorWorkingHoursService.getDoctorWorkingHoursByDoctorId(t)}getDoctorUpcomingAppointmentsDates(t){return this.appointmentService.getDoctorUpcomingAppointmentsDates(t)}generateDays(){const t=new Date,i=[];for(let r=0;r<7;r++){const c=new Date(t);c.setDate(t.getDate()+r),i.push(c)}return i}generateTimeSlots(t){const i=[];return t.forEach(r=>{const c=r.getDay(),l=this.doctorWorkingHours.find(d=>d.dayOfWeek===c);if(l){const d=new Date(r.toDateString()+" "+l.startTime),g=new Date(r.toDateString()+" "+l.endTime);for(let _=new Date(d);_<g;_.setMinutes(_.getMinutes()+30))i.push(new Date(_))}}),i}generateAvailableTimeSlots(t){const i=this.doctorBookedDates.map(c=>new Date(c));return t.filter(c=>!i.some(l=>l.getTime()===c.getTime()))}getAvailableDays(){const t=new Set;this.availableTimeSlots.forEach(i=>{t.add(i.toDateString())}),this.availableDays=Array.from(t)}getDayAvailableTimes(){if(this.selectedDay){const t=new Date(this.selectedDay);this.availableTimesForSelectedDay=this.availableTimeSlots.filter(r=>r.toDateString()===t.toDateString());const i=new Date(this.selectedTime);this.availableTimesForSelectedDay.some(r=>new Date(r).getTime()===i.getTime())||(this.selectedTime=this.availableTimesForSelectedDay[0])}}selectDayAndTime(){if(this.selectedDay&&this.selectedTime){const t=new Date(this.selectedDay),i=new Date(this.selectedTime);return t.setHours(i.getHours(),i.getMinutes()),this.datePipe.transform(t,"yyyy-MM-ddTHH:mm:ss.SSSSSSS")}return null}submitUpdateAppointmentForm(){this.UpdateAppointmentForm.valid&&(this.UpdateAppointmentForm.get("dateOfVisit")?.setValue(this.selectDayAndTime()),this.updateAppointment())}mapFormToAppointment(){return{id:this.UpdateAppointmentForm.get("id")?.value,appointmentSpecialityId:this.UpdateAppointmentForm.get("appointmentSpecialityId")?.value,dateOfVisit:this.UpdateAppointmentForm.get("dateOfVisit")?.value,doctorId:this.UpdateAppointmentForm.get("doctorId")?.value,patientId:this.UpdateAppointmentForm.get("patientId")?.value,status:this.UpdateAppointmentForm.get("status")?.value,type:this.UpdateAppointmentForm.get("type")?.value,dateCreated:this.appointment?.dateCreated}}updateAppointment(){const t=this.mapFormToAppointment();this.appointmentService.updateAppointment(t).subscribe({next:i=>{this.toastr.success("Appointment Updated Successfully")},error:i=>{this.validationErrors=i}})}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(a.qu),e.Y36(x.d),e.Y36(Q.K),e.Y36(L.i),e.Y36(Z.H),e.Y36(A.gz),e.Y36(v.uU),e.Y36(O._W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-update-appointment"]],decls:43,vars:21,consts:[["cForm","","autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],[1,"mb-3"],["cLabel",""],["name","type","aria-label","type","cSelect","","formControlName","type"],["value",""],[3,"value",4,"ngFor","ngForOf"],["name","appointmentSpecialityId","cSelect","","formControlName","appointmentSpecialityId"],[3,"items","virtualScroll","ngModel","bindLabel","ngModelOptions","ngModelChange","search","change"],["class","row",4,"ngIf"],["formControlName","creationNote","rows","3",1,"form-control"],[1,"d-flex","flex-row","w-100","align-items-center","justify-content-around"],["type","submit","class","btn btn-primary",4,"ngIf"],["type","button","class","btn btn-primary",3,"routerLink",4,"ngIf"],[3,"value"],["cSelect","",3,"ngModel","ngModelOptions","ngModelChange","change"],["disabled","","value","null"],["cSelect","",3,"ngModel","ngModelOptions","ngModelChange"],[1,"text-danger"],[4,"ngFor","ngForOf"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-primary",3,"routerLink"]],template:function(t,i){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return i.submitUpdateAppointmentForm()}),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"label",4),e._uU(5,"Type"),e.qZA(),e.TgZ(6,"select",5)(7,"option",6),e._uU(8,"Type"),e.qZA(),e.YNc(9,ge,2,2,"option",7),e.qZA()()(),e.TgZ(10,"div",2)(11,"div",3)(12,"label",4),e._uU(13,"Speciality"),e.qZA(),e.TgZ(14,"select",8)(15,"option",6),e._uU(16,"Speciality"),e.qZA(),e.YNc(17,_e,2,2,"option",7),e.qZA()()()(),e.TgZ(18,"div",1)(19,"div",2)(20,"div",3)(21,"label",4),e._uU(22,"Patient"),e.qZA(),e.TgZ(23,"ng-select",9),e.NdJ("ngModelChange",function(c){return i.selectedPatient=c})("search",function(c){return i.searchPatients(c)})("change",function(c){return i.onPatientSelect(c)}),e.qZA()()(),e.TgZ(24,"div",2)(25,"div",3)(26,"label",4),e._uU(27,"Doctor"),e.qZA(),e.TgZ(28,"ng-select",9),e.NdJ("ngModelChange",function(c){return i.selectedDoctor=c})("search",function(c){return i.searchDoctors(c)})("change",function(c){return i.onDoctorSelect(c)}),e.qZA()()()(),e.YNc(29,Ae,17,8,"div",10),e.TgZ(30,"div",1)(31,"div",2)(32,"div",3)(33,"label",4),e._uU(34,"Note"),e.qZA(),e._UZ(35,"textarea",11),e.qZA()()(),e.YNc(36,be,3,1,"div",10),e.TgZ(37,"div",12),e.YNc(38,Ze,2,0,"button",13),e.YNc(39,Ie,2,3,"button",14),e.YNc(40,Ce,2,3,"button",14),e.YNc(41,De,2,3,"button",14),e.qZA()(),e._UZ(42,"hr")),2&t&&(e.Q6J("formGroup",i.UpdateAppointmentForm),e.xp6(9),e.Q6J("ngForOf",i.typeList),e.xp6(8),e.Q6J("ngForOf",i.specialityList),e.xp6(6),e.Q6J("items",i.patientList)("virtualScroll",!0)("ngModel",i.selectedPatient)("bindLabel","fullName")("ngModelOptions",e.DdM(19,F)),e.xp6(5),e.Q6J("items",i.doctorList)("virtualScroll",!0)("ngModel",i.selectedDoctor)("bindLabel","fullName")("ngModelOptions",e.DdM(20,F)),e.xp6(1),e.Q6J("ngIf",i.availableTimeSlots.length>0),e.xp6(7),e.Q6J("ngIf",i.validationErrors.length>0),e.xp6(2),e.Q6J("ngIf","Booked"==(null==i.appointment?null:i.appointment.status)),e.xp6(1),e.Q6J("ngIf","Booked"==(null==i.appointment?null:i.appointment.status)),e.xp6(1),e.Q6J("ngIf","Finalized"==(null==i.appointment?null:i.appointment.status)),e.xp6(1),e.Q6J("ngIf","Finalized"==(null==i.appointment?null:i.appointment.status)||"Invoiced"==(null==i.appointment?null:i.appointment.status)))},dependencies:[A.rH,v.sg,v.O5,a._Y,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.On,u.nqR,u.$_X,u.eFW,a.sg,a.u,D.w9,v.uU]}),s})();const Y=(o,s)=>(0,e.f3M)(Z.H).getAppointmentById(o.paramMap.get("id")),Ue=[{value:"cash",display:"Cash"},{value:"visa",display:"Visa"}];var H=p(4007),K=p(7354),qe=p(5516),z=p(7398),Fe=p(9862);let P=(()=>{var o;class s{constructor(t,i){this.http=t,this.appoinmentService=i,this.baseUrl=qe.N.apiUrl}createInvoice(t){return this.http.post(this.baseUrl+"invoice/",t).pipe((0,z.U)(i=>(this.appoinmentService.invalidateAppointmentCache(),i)))}updateInvoice(t){return this.http.put(this.baseUrl+"invoice/",t).pipe((0,z.U)(i=>(this.appoinmentService.invalidateAppointmentCache(),i)))}getInvoice(t){return this.http.get(this.baseUrl+"invoice/"+t)}updateInvoiceDebt(t,i){return this.http.put(this.baseUrl+"invoice/updateInvoiceDebt/"+t,i)}}return(o=s).\u0275fac=function(t){return new(t||o)(e.LFG(Fe.eN),e.LFG(Z.H))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),s})();var B=p(4099),G=p(923);function Pe(o,s){1&o&&(e.TgZ(0,"div",19)(1,"div",20)(2,"div",3),e._UZ(3,"app-text-input",21),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"app-text-input",22),e.qZA(),e.TgZ(6,"div",3),e._UZ(7,"app-text-input",23),e.qZA(),e.TgZ(8,"div",3),e._UZ(9,"app-text-input",24),e.qZA(),e.TgZ(10,"div",3),e._UZ(11,"app-text-input",25),e.qZA()()()),2&o&&e.Q6J("formGroupName",s.index)}function Ne(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",19)(1,"div",2)(2,"div",3)(3,"label"),e._uU(4,"Service Name"),e.qZA(),e._UZ(5,"app-text-input",26),e.qZA(),e.TgZ(6,"div",3)(7,"label"),e._uU(8,"Service Price"),e.qZA(),e._UZ(9,"app-text-input",27),e.qZA(),e.TgZ(10,"div",3)(11,"label"),e._uU(12,"Quantity"),e.qZA(),e.TgZ(13,"app-text-input",28),e.NdJ("change",function(){const r=e.CHM(n).index,c=e.oxw(2);return e.KtG(c.quantityChanged(r))}),e.qZA()(),e.TgZ(14,"div",3)(15,"label"),e._uU(16,"Service Total Price"),e.qZA(),e._UZ(17,"app-text-input",29),e.qZA()()()}2&o&&e.Q6J("formGroupName",s.index)}function Oe(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",19)(1,"div",2)(2,"div",3)(3,"label"),e._uU(4,"Item Name"),e.qZA(),e._UZ(5,"app-text-input",30),e.qZA(),e.TgZ(6,"div",3)(7,"label"),e._uU(8,"Item Price"),e.qZA(),e._UZ(9,"app-text-input",31),e.qZA(),e.TgZ(10,"div",3)(11,"label"),e._uU(12,"Units"),e.qZA(),e._UZ(13,"app-text-input",32),e.qZA(),e.TgZ(14,"div",33)(15,"div",34)(16,"label"),e._uU(17,"Remove"),e.qZA(),e.TgZ(18,"button",35),e.NdJ("click",function(){const r=e.CHM(n).index,c=e.oxw(2);return e.KtG(c.removeCustomItem(r))}),e.O4$(),e._UZ(19,"svg",36),e.qZA()()()()()}2&o&&e.Q6J("formGroupName",s.index)}function we(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"button",38),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(3);return e.KtG(i.calculateTotals())}),e._uU(1,"Caclulate/Refresh Totals"),e.qZA()}}function Je(o,s){if(1&o&&(e.TgZ(0,"div",11)(1,"div",12),e.YNc(2,we,2,0,"button",37),e.qZA()()),2&o){const n=e.oxw(2);e.xp6(2),e.Q6J("ngIf",n.createInvoiceForm.controls.customItems.controls.length>0||n.createInvoiceForm.controls.invoiceSelectedServices.controls.length>0)}}function ke(o,s){if(1&o&&(e.TgZ(0,"option",47),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.Q6J("value",n.value),e.xp6(1),e.hij(" ",n.display," ")}}function Qe(o,s){if(1&o){const n=e.EpF();e.ynx(0),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4)(4,"label",5),e._uU(5,"Appointment Type Price"),e.qZA(),e._UZ(6,"input",39),e.qZA()()(),e.TgZ(7,"div",2)(8,"div",3)(9,"div",4)(10,"label",5),e._uU(11,"Total Price"),e.qZA(),e._UZ(12,"app-text-input",40),e.qZA()(),e.TgZ(13,"div",3)(14,"div",4)(15,"label",5),e._uU(16,"Discount"),e.qZA(),e.TgZ(17,"app-text-input",41),e.NdJ("change",function(){e.CHM(n);const i=e.oxw(2);let r;return e.KtG(i.changeTotalAfterDiscount(null==(r=i.createInvoiceForm.get("discountPercentage"))?null:r.value))}),e.qZA()()()(),e.TgZ(18,"div",2)(19,"div",3)(20,"div",4)(21,"label",5),e._uU(22,"Total Paid"),e.qZA(),e.TgZ(23,"app-text-input",42),e.NdJ("change",function(i){e.CHM(n);const r=e.oxw(2);return e.KtG(r.changeTotalRemaning(i))}),e.qZA()()(),e.TgZ(24,"div",3)(25,"div",4)(26,"label",5),e._uU(27,"Total After Discount"),e.qZA(),e._UZ(28,"app-text-input",43),e.qZA()()(),e.TgZ(29,"div",2)(30,"div",3)(31,"div",4)(32,"label",5),e._uU(33,"Total Remaning"),e.qZA(),e._UZ(34,"app-text-input",44),e.qZA()(),e.TgZ(35,"div",3)(36,"div",4)(37,"label",5),e._uU(38,"Payment Method"),e.qZA(),e.TgZ(39,"select",45),e.YNc(40,ke,2,2,"option",46),e.qZA()()()(),e.BQk()}if(2&o){const n=e.oxw(2);e.xp6(6),e.Q6J("value",null==n.invoice?null:n.invoice.appointmentTypePrice),e.xp6(11),e.Q6J("label","Discount"),e.xp6(23),e.Q6J("ngForOf",n.paymentMethodList)}}function Le(o,s){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.xp6(1),e.hij(" ",n," ")}}function Ee(o,s){if(1&o&&(e.TgZ(0,"div",2)(1,"ul",48),e.YNc(2,Le,2,1,"li",49),e.qZA()()),2&o){const n=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",n.validationErrors)}}const V=function(){return{standalone:!0}};function Ye(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"form",1),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.createInvoiceForm.valid&&i.createInvoice())}),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4)(4,"label",5),e._uU(5,"Medicine"),e.qZA(),e.TgZ(6,"ng-select",6),e.NdJ("search",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.searchMedicines(i))})("change",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onMedicineSelect(i))})("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedMedicines=i)}),e.qZA()()()(),e.TgZ(7,"div",7),e.YNc(8,Pe,12,1,"div",8),e.qZA(),e.TgZ(9,"div",2)(10,"div",3)(11,"div",4)(12,"label",5),e._uU(13,"Select Services"),e.qZA(),e.TgZ(14,"ng-select",9),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedServices=i)})("change",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onServiceSelect(i))})("remove",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.invoiceRemoveService(i))}),e.qZA()()()(),e.TgZ(15,"div",10),e.YNc(16,Ne,18,1,"div",8),e.qZA(),e.TgZ(17,"div",11)(18,"div",12)(19,"button",13),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.pushNewCustomItem())}),e._uU(20,"Add A Custom Item"),e.qZA()()(),e.TgZ(21,"div",14),e.YNc(22,Oe,20,1,"div",8),e.qZA(),e.YNc(23,Je,3,1,"div",15),e.YNc(24,Qe,41,3,"ng-container",16),e.TgZ(25,"div",11)(26,"div",12)(27,"button",17),e._uU(28,"Update"),e.qZA()()(),e.YNc(29,Ee,3,1,"div",18),e.qZA()}if(2&o){const n=e.oxw();let t;e.Q6J("formGroup",n.createInvoiceForm),e.xp6(6),e.Q6J("items",n.medicineList)("virtualScroll",!0)("bindLabel","name")("bindValue","id")("multiple",!0)("ngModel",n.selectedMedicines)("ngModelOptions",e.DdM(23,V))("compareWith",n.compareFn),e.xp6(2),e.Q6J("ngForOf",n.createInvoiceForm.controls.invoiceMedicines.controls),e.xp6(6),e.Q6J("ngModel",n.selectedServices)("items",n.services)("virtualScroll",!0)("multiple",!0)("bindLabel","name")("ngModelOptions",e.DdM(24,V))("clearable",!1),e.xp6(2),e.Q6J("ngForOf",n.createInvoiceForm.controls.invoiceSelectedServices.controls),e.xp6(6),e.Q6J("ngForOf",n.createInvoiceForm.controls.customItems.controls),e.xp6(1),e.Q6J("ngIf",!n.isDoctor()),e.xp6(1),e.Q6J("ngIf",(null==(t=n.createInvoiceForm.get("totalPrice"))?null:t.value)>0&&(n.createInvoiceForm.controls.customItems.controls.length>0||n.createInvoiceForm.controls.invoiceSelectedServices.controls.length>0)),e.xp6(3),e.Q6J("disabled",!n.createInvoiceForm.valid),e.xp6(2),e.Q6J("ngIf",n.validationErrors.length>0)}}let He=(()=>{var o;class s{constructor(t,i,r,c,l,d,g,_){this.fb=t,this.route=i,this.doctorServiceService=r,this.serviceService=c,this.invoiceService=l,this.router=d,this.medicineService=g,this.accountService=_,this.doctor_services=[],this.services=[],this.selectedServices=[],this.validationErrors=[],this.paymentMethodList=Ue,this.medicineList=[],this.selectedMedicines=[],this.medicineParams={pageNumber:1,pageSize:5}}ngOnInit(){this.route.data.subscribe(t=>{this.invoice=t.invoice,this.accountService.currentUser$.pipe((0,C.q)(1)).subscribe(i=>this.currentUser=i),this.appointment=this.invoice?.appointment,this.getDoctorServicesByDoctorId(),this.initializeForm(),this.intializeMedicineList()})}isDoctor(){return this.currentUser?.roles.includes(T.K.DOCTOR)}compareFn(t,i){return t&&i?t.id===i.id:t===i}searchMedicines(t){t.term.trim().length>1&&(this.medicineParams.searchTerm=t.term,this.medicineService.getMedicines(this.medicineParams).subscribe(i=>{this.medicineList=i.result}))}onMedicineSelect(t){this.updateSelectedMedicineItems(t)}intializeMedicineList(){this.selectedMedicines=this.invoice?.invoiceMedicines?this.invoice.invoiceMedicines.map(t=>t.medicine).filter(t=>void 0!==t):[],this.medicineList=this.selectedMedicines,this.updateSelectedMedicineItems(this.invoice?.invoiceMedicines)}updateSelectedMedicineItems(t){this.removeUnselectedMedicineItems(t),this.addNewMedicineItems(t)}removeUnselectedMedicineItems(t){const i=this.createInvoiceForm.get("invoiceMedicines");for(let r=i.length-1;r>=0;r--){const c=i.at(r).get("medicineId")?.value;t.some(l=>l.id===c)||i.removeAt(r)}}addNewMedicineItems(t){const i=this.createInvoiceForm.get("invoiceMedicines");t.forEach(r=>{i.controls.find(l=>l.get("medicineId")?.value===r.id)||i.push(this.fb.group({medicineName:[{value:r.name,disabled:!0}],medicineId:[null==r.medicineId?r.id:r.medicineId],dosageAmount:[""==r.dosageAmount?"":r.dosageAmount,a.kI.required],duration:[""==r.duration?"":r.duration,a.kI.required],frequency:[""==r.frequency?"":r.frequency,a.kI.required],note:[""==r.note?"":r.note]}))})}getDoctorServicesByDoctorId(){this.doctorServiceService.getDoctorServiceByDocorId(this.appointment.doctorId.toString()).subscribe(t=>{this.doctor_services=t,this.services=this.doctor_services.map(i=>i.service),this.intializeDoctorServices()})}intializeDoctorServices(){const t=this.doctor_services.filter(r=>this.invoice?.invoiceDoctorServices.some(c=>c.doctorServiceId===r.id));this.selectedServices=t.map(r=>r.service);const i=this.createInvoiceForm.get("invoiceSelectedServices");for(const r of this.invoice?.invoiceDoctorServices){const c=t.find(l=>l.id==r.doctorServiceId);i.push(this.fb.group({serviceName:[{value:r.serviceName,disabled:!0},a.kI.required],servicePrice:[{value:r.serviceSoldPrice,disabled:!0},a.kI.required],quantity:[r.serviceQuantity,[a.kI.required,a.kI.min(1)]],serviceId:[c?.serviceId,a.kI.required],servicetotalPrice:[{value:r.totalPrice,disabled:!0},a.kI.required],serviceDisposablePrice:[r.totalDisposablesPrice]}))}}initializeCustomItems(){const t=this.createInvoiceForm.get("customItems");if(this.invoice?.customItems)for(const i of this.invoice.customItems)t.push(this.fb.group({name:[i.name,a.kI.required],price:[i.price,[a.kI.required,a.kI.min(1)]],units:[i.units,[a.kI.required,a.kI.min(1)]]}))}initializeForm(){this.createInvoiceForm=this.fb.group({invoiceSelectedServices:this.fb.array([]),customItems:this.fb.array([]),totalPrice:[{value:0,disabled:!0},[a.kI.required]],totalPaid:[0,[a.kI.required]],totalRemaning:[{value:0,disabled:!0},[a.kI.required]],totalAfterDiscount:[{value:0,disabled:!0},[a.kI.required]],discountPercentage:[0,[a.kI.required,a.kI.max(100),a.kI.min(0)]],paymentMethod:["cash",a.kI.required],invoiceMedicines:this.fb.array([])}),this.initializeCustomItems()}pushNewCustomItem(){this.createInvoiceForm.get("customItems").push(this.fb.group({name:["",a.kI.required],price:[1,[a.kI.required,a.kI.min(1)]],units:[1,[a.kI.required,a.kI.min(1)]]}))}removeCustomItem(t){this.createInvoiceForm.get("customItems").removeAt(t)}onServiceSelect(t){this.updateSelectedService(t)}invoiceRemoveService(t){const i=this.createInvoiceForm.get("invoiceSelectedServices"),r=i.controls.findIndex(c=>c.get("serviceId")?.value===t.value.id);-1!==r&&i.removeAt(r)}updateSelectedService(t){const i=this.createInvoiceForm.get("invoiceSelectedServices");t.forEach(r=>{const c=r.id;i.controls.some(d=>d.get("serviceId")?.value===c)||this.getServiceDisposablePrice(c,1).subscribe(d=>{i.push(this.fb.group({serviceName:[{value:r.name,disabled:!0},a.kI.required],servicePrice:[{value:r.totalPrice,disabled:!0},a.kI.required],quantity:[1,[a.kI.required,a.kI.min(1)]],serviceId:[r.id,a.kI.required],servicetotalPrice:[{value:r.totalPrice+d,disabled:!0},a.kI.required],serviceDisposablePrice:[d]}))})})}getServiceDisposablePrice(t,i){return this.serviceService.getServiceDispsablesPrice(t,i)}quantityChanged(t){const r=this.createInvoiceForm.get("invoiceSelectedServices").at(t);var c=r.getRawValue().quantity;if(!(c<=0)){var l=r.getRawValue().serviceId,d=r.getRawValue().servicePrice;this.getServiceDisposablePrice(l,c).subscribe({next:g=>{r.get("disposablesPrice")?.setValue(g);var _=d*c+g;r.get("servicetotalPrice")?.setValue(_)},error:g=>{r.get("quantity")?.setValue(1)}})}}mapInvoiceFormToCreateInvoice(){return{id:this.invoice?.id,appointmentId:this.appointment?.id,paymentMethod:this.createInvoiceForm.get("paymentMethod")?.value,discountPercentage:this.createInvoiceForm.get("discountPercentage")?.value,totalPaid:this.createInvoiceForm.get("totalPaid")?.value,invoiceDoctorServices:this.mapCreateDoctorService(),customItems:this.createInvoiceForm.get("customItems")?.value,invoiceMedicines:this.createInvoiceForm.get("invoiceMedicines")?.value}}createInvoice(){var t=this.mapInvoiceFormToCreateInvoice();this.invoiceService.updateInvoice(t).subscribe(i=>{this.sendToInvoiceView(i)})}sendToInvoiceView(t){this.router.navigate(["appointments/view-invoice/"+t.id])}mapCreateDoctorService(){const t=[];return this.createInvoiceForm.get("invoiceSelectedServices").controls.forEach(r=>{const c={doctorServiceId:this.doctor_services?.find(l=>l.serviceId==r.get("serviceId")?.value)?.id,serviceQuantity:r.get("quantity")?.value};t.push(c)}),t}resetTotals(){this.setTotalPrice(0),this.createInvoiceForm.get("discountPercentage")?.setValue(this.invoice?.discountPercentage),this.createInvoiceForm.get("totalPaid")?.setValue(this.invoice?.totalPaid)}calculateTotals(){this.resetTotals();const t=this.createInvoiceForm.get("invoiceSelectedServices"),i=this.createInvoiceForm.get("customItems");this.appendTypePriceToTotal(),t.length>0&&this.calculateServiceTotals(t),i.length>0&&this.calculateCustomItemsTotals(i),this.changeTotalAfterDiscount(this.invoice?.discountPercentage)}appendTypePriceToTotal(){var t=this.invoice?.appointmentTypePrice,i=this.createInvoiceForm.get("totalPrice")?.value+t;this.setTotalPrice(i)}calculateServiceTotals(t){const i=t.controls.reduce((c,l)=>{const d=l.get("servicetotalPrice")?.value;return c+d},0);var r=this.createInvoiceForm.get("totalPrice")?.value+i;this.setTotalPrice(r)}calculateCustomItemsTotals(t){const i=t.controls.reduce((c,l)=>{const d=l.get("price")?.value,g=l.get("units")?.value;return c+d*g},0);var r=this.createInvoiceForm.get("totalPrice")?.value+i;this.setTotalPrice(r)}changeTotalAfterDiscount(t){this.setTotalAfterDiscount(t),this.setRemaningTotal(this.createInvoiceForm.get("totalPaid")?.value)}setTotalAfterDiscount(t){this.createInvoiceForm.get("totalAfterDiscount")?.setValue(this.createInvoiceForm.get("totalPrice")?.value*(1-t/100))}changeTotalRemaning(t){this.setRemaningTotal(t.target.value)}setRemaningTotal(t){this.createInvoiceForm.get("totalRemaning")?.setValue(this.createInvoiceForm.get("totalAfterDiscount")?.value-t)}setTotalPrice(t){this.createInvoiceForm.get("totalPrice")?.setValue(t),this.createInvoiceForm.get("totalAfterDiscount")?.setValue(t),this.createInvoiceForm.get("totalRemaning")?.setValue(t)}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(a.qu),e.Y36(A.gz),e.Y36(H.M),e.Y36(K.m),e.Y36(P),e.Y36(A.F0),e.Y36(B.A),e.Y36(m.B))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-finalize-appointment"]],decls:1,vars:1,consts:[["cForm","","autocomplete","off",3,"formGroup","ngSubmit",4,"ngIf"],["cForm","","autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],[1,"mb-3"],["cLabel",""],[3,"items","virtualScroll","bindLabel","bindValue","multiple","ngModel","ngModelOptions","compareWith","search","change","ngModelChange"],["formArrayName","invoiceMedicines",1,"mb-3"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"ngModel","items","virtualScroll","multiple","bindLabel","ngModelOptions","clearable","ngModelChange","change","remove"],["formArrayName","invoiceSelectedServices",1,"mb-3"],[1,"row","mb-3","d-flex","justify-content-center"],[1,"col-6","text-center"],["cButton","","color","success",3,"click"],["formArrayName","customItems",1,"mb-3"],["class","row mb-3 d-flex justify-content-center",4,"ngIf"],[4,"ngIf"],["cButton","","color","primary","type","submit",3,"disabled"],["class","row",4,"ngIf"],[3,"formGroupName"],[1,"row","mb-3"],["formControlName","medicineName","label","Medicine Name"],["formControlName","dosageAmount","label","Dosage Amount"],["formControlName","duration","label","Duration"],["formControlName","frequency","label","Frequency"],["formControlName","note","label","Note"],["formControlName","serviceName","label","Service Name"],["formControlName","servicePrice","label","Service Price"],["type","number","formControlName","quantity","label","Quantity",3,"change"],["type","number","formControlName","servicetotalPrice","label","Service Total Price"],["formControlName","name","label","Item Name"],["type","number","formControlName","price","label","Item Price"],["type","number","formControlName","units","label","Units"],[1,"col-1"],[1,"d-flex","flex-column"],["cButton","","color","danger",1,"btn-m",3,"click"],["cIcon","","name","cil-trash"],["cButton","","color","dark",3,"click",4,"ngIf"],["cButton","","color","dark",3,"click"],["disabled","",1,"form-control",3,"value"],["type","number","formControlName","totalPrice"],["type","number","formControlName","discountPercentage",3,"label","change"],["type","number","formControlName","totalPaid",3,"change"],["type","number","formControlName","totalAfterDiscount"],["type","number","formControlName","totalRemaning"],["name","paymentMethod","cSelect","","formControlName","paymentMethod"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"text-danger"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&e.YNc(0,Ye,30,25,"form",0),2&t&&e.Q6J("ngIf",i.doctor_services)},dependencies:[v.sg,v.O5,a._Y,a.YN,a.Kr,a.EJ,a.JJ,a.JL,a.On,u.nqR,G.t,h.ar,u.Hq3,u.$_X,u.eFW,a.sg,a.u,a.x0,a.CE,D.w9]}),s})(),Ke=(()=>{class o{constructor(){this._printStyle=[],this.previewOnly=!1,this.useExistingCss=!1,this.printDelay=0,this._styleSheetFile=""}set printStyle(n){for(let t in n)n.hasOwnProperty(t)&&this._printStyle.push((t+JSON.stringify(n[t])).replace(/['"]+/g,""));this.returnStyleValues()}returnStyleValues(){return`<style> ${this._printStyle.join(" ").replace(/,/g,";")} </style>`}set styleSheetFile(n){let t=function(i){return`<link rel="stylesheet" type="text/css" href="${i}">`};if(-1!==n.indexOf(",")){const i=n.split(",");for(let r of i)this._styleSheetFile=this._styleSheetFile+t(r)}else this._styleSheetFile=t(n)}returnStyleSheetLinkTags(){return this._styleSheetFile}getElementTag(n){const t=[],i=document.getElementsByTagName(n);for(let r=0;r<i.length;r++)t.push(i[r].outerHTML);return t.join("\r\n")}getFormData(n){for(var t=0;t<n.length;t++)n[t].defaultValue=n[t].value,n[t].checked&&(n[t].defaultChecked=!0)}getHtmlContents(){let n=document.getElementById(this.printSectionId),t=n.getElementsByTagName("input");this.getFormData(t);let i=n.getElementsByTagName("textarea");return this.getFormData(i),n.innerHTML}print(){let n,t,i="",r="";const c=this.getElementTag("base");this.useExistingCss&&(i=this.getElementTag("style"),r=this.getElementTag("link")),n=this.getHtmlContents(),t=window.open("","_blank","top=0,left=0,height=auto,width=auto"),t.document.open(),t.document.write(`\n      <html>\n        <head>\n          <title>${this.printTitle?this.printTitle:""}</title>\n          ${c}\n          ${this.returnStyleValues()}\n          ${this.returnStyleSheetLinkTags()}\n          ${i}\n          ${r}\n        </head>\n        <body>\n          ${n}\n          <script defer>\n            function triggerPrint(event) {\n              window.removeEventListener('load', triggerPrint, false);\n              ${this.previewOnly?"":`setTimeout(function() {\n                closeWindow(window.print());\n              }, ${this.printDelay});`}\n            }\n            function closeWindow(){\n                window.close();\n            }\n            window.addEventListener('load', triggerPrint, false);\n          <\/script>\n        </body>\n      </html>`),t.document.close()}}return o.\u0275fac=function(n){return new(n||o)},o.\u0275dir=e.lG2({type:o,selectors:[["button","ngxPrint",""]],hostBindings:function(n,t){1&n&&e.NdJ("click",function(){return t.print()})},inputs:{previewOnly:"previewOnly",printSectionId:"printSectionId",printTitle:"printTitle",useExistingCss:"useExistingCss",printDelay:"printDelay",printStyle:"printStyle",styleSheetFile:"styleSheetFile"}}),o})(),ze=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({}),o})();function Be(o,s){if(1&o&&(e.TgZ(0,"div",10)(1,"h5"),e._uU(2),e.qZA(),e.TgZ(3,"div",11)(4,"p",12),e._uU(5),e.qZA(),e.TgZ(6,"p",12),e._uU(7),e.qZA(),e.TgZ(8,"p",12),e._uU(9),e.qZA(),e.TgZ(10,"p",12),e._uU(11),e.qZA()()()),2&o){const n=s.$implicit;e.xp6(2),e.hij("R/ ",null==n.medicine?null:n.medicine.name,""),e.xp6(3),e.hij("\u0627\u0644\u062c\u0631\u0639\u0629: ",n.dosageAmount,""),e.xp6(2),e.hij("\u0643\u0627\u0645 \u0645\u0631\u0629 \u0641\u0649 \u0627\u0644\u064a\u0648\u0645: ",n.frequency,""),e.xp6(2),e.hij("\u0644\u0645\u062f\u0629: ",n.duration,""),e.xp6(2),e.hij("\u0645\u0644\u062d\u0648\u0638\u0629: ",n.note,"")}}let Ge=(()=>{var o;class s{getCurrentDate(){return new Date}}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-prescription"]],inputs:{invoice:"invoice"},decls:33,vars:8,consts:[["id","prescription",1,"text-end","w-100"],["src","assets/img/brand/logo.png","width","200","height","200",1,"img-fluid"],[2,"margin-top","-4rem"],[1,"text-center"],[1,"text-center","text-decoration-underline","mt-3"],[1,"container","text-start","mt-5"],[1,"row","row-cols-2"],[1,"col"],[1,"h6",2,"border-bottom","1px dotted"],["class","mt-5",4,"ngFor","ngForOf"],[1,"mt-5"],[1,"d-flex","flex-row-reverse","justify-content-between",2,"direction","rtl"],[2,"border-bottom","1px dotted"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"img",1),e.TgZ(2,"div",2)(3,"h1",3),e._uU(4,"Retaj Hospital"),e.qZA(),e.TgZ(5,"h2",4),e._uU(6),e.qZA(),e._UZ(7,"hr"),e.TgZ(8,"div",5)(9,"div",6)(10,"div",7)(11,"h4"),e._uU(12,"Name: "),e.TgZ(13,"span",8),e._uU(14),e.qZA()()(),e.TgZ(15,"div",7)(16,"h4"),e._uU(17,"Date: "),e.TgZ(18,"span",8),e._uU(19),e.ALo(20,"date"),e.qZA()()(),e.TgZ(21,"div",7)(22,"h4"),e._uU(23,"Age: "),e.TgZ(24,"span",8),e._uU(25),e.qZA()()(),e.TgZ(26,"div",7)(27,"h4"),e._uU(28,"Diagonses: "),e.TgZ(29,"span",8),e._uU(30,"\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0\xa0"),e.qZA()()()()()(),e._UZ(31,"hr"),e.YNc(32,Be,12,5,"div",9),e.qZA()),2&t&&(e.xp6(6),e.hij("Dr. ",i.invoice.doctor.fullName,""),e.xp6(8),e.Oqu(i.invoice.patient.fullName),e.xp6(5),e.Oqu(e.xi3(20,5,i.getCurrentDate(),"MM/dd/yyyy")),e.xp6(6),e.Oqu(i.invoice.patient.age),e.xp6(7),e.Q6J("ngForOf",i.invoice.invoiceMedicines))},dependencies:[v.sg,v.uU]}),s})();function Ve(o,s){if(1&o&&(e.TgZ(0,"a",5),e._uU(1," Totals "),e.qZA()),2&o){e.oxw();const n=e.MAs(14);e.Q6J("cTabContent",n)("tabPaneIdx",3)}}function Re(o,s){if(1&o&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"label"),e._uU(4,"Service Name"),e.qZA(),e._UZ(5,"input",14),e.qZA()(),e.TgZ(6,"div",12)(7,"div",13)(8,"label"),e._uU(9,"Quantity"),e.qZA(),e._UZ(10,"input",14),e.qZA()(),e.TgZ(11,"div",12)(12,"div",13)(13,"label"),e._uU(14,"Service Sold Price"),e.qZA(),e._UZ(15,"input",14),e.qZA()(),e.TgZ(16,"div",12)(17,"div",13)(18,"label"),e._uU(19,"Total Disposable Price"),e.qZA(),e._UZ(20,"input",14),e.qZA()(),e.TgZ(21,"div",12)(22,"div",13)(23,"label"),e._uU(24,"Total Price"),e.qZA(),e._UZ(25,"input",14),e.qZA()()()),2&o){const n=s.$implicit;e.xp6(5),e.s9C("value",n.serviceName),e.xp6(5),e.s9C("value",n.serviceQuantity),e.xp6(5),e.s9C("value",n.serviceSoldPrice),e.xp6(5),e.s9C("value",n.totalDisposablesPrice),e.xp6(5),e.s9C("value",n.totalPrice)}}function $e(o,s){if(1&o&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"label"),e._uU(4,"Item Name"),e.qZA(),e._UZ(5,"input",14),e.qZA()(),e.TgZ(6,"div",12)(7,"div",13)(8,"label"),e._uU(9,"Units"),e.qZA(),e._UZ(10,"input",14),e.qZA()(),e.TgZ(11,"div",12)(12,"div",13)(13,"label"),e._uU(14,"Item Price"),e.qZA(),e._UZ(15,"input",14),e.qZA()(),e.TgZ(16,"div",12)(17,"div",13)(18,"label"),e._uU(19,"Item Total Price"),e.qZA(),e._UZ(20,"input",14),e.qZA()()()),2&o){const n=s.$implicit;e.xp6(5),e.s9C("value",n.name),e.xp6(5),e.s9C("value",n.units),e.xp6(5),e.s9C("value",n.price),e.xp6(5),e.s9C("value",n.totalPrice)}}function We(o,s){if(1&o&&(e.TgZ(0,"div",11)(1,"div",12)(2,"div",13)(3,"label"),e._uU(4,"Medicine Name"),e.qZA(),e._UZ(5,"input",14),e.qZA()(),e.TgZ(6,"div",12)(7,"div",13)(8,"label"),e._uU(9,"Dosage"),e.qZA(),e._UZ(10,"input",14),e.qZA()(),e.TgZ(11,"div",12)(12,"div",13)(13,"label"),e._uU(14,"Duration"),e.qZA(),e._UZ(15,"input",14),e.qZA()(),e.TgZ(16,"div",12)(17,"div",13)(18,"label"),e._uU(19,"Frequency"),e.qZA(),e._UZ(20,"input",14),e.qZA()(),e.TgZ(21,"div",12)(22,"div",13)(23,"label"),e._uU(24,"Note"),e.qZA(),e._UZ(25,"input",14),e.qZA()()()),2&o){const n=s.$implicit;e.xp6(5),e.s9C("value",null==n.medicine?null:n.medicine.name),e.xp6(5),e.s9C("value",n.dosageAmount),e.xp6(5),e.s9C("value",n.duration),e.xp6(5),e.s9C("value",n.frequency),e.xp6(5),e.s9C("value",n.note)}}function je(o,s){if(1&o){const n=e.EpF();e.ynx(0),e.TgZ(1,"c-nav",3)(2,"c-nav-item")(3,"a",4),e._uU(4," Services Used "),e.qZA()(),e.TgZ(5,"c-nav-item")(6,"a",5),e._uU(7," Custom Items "),e.qZA()(),e.TgZ(8,"c-nav-item")(9,"a",5),e._uU(10," Medicines "),e.qZA()(),e.TgZ(11,"c-nav-item"),e.YNc(12,Ve,2,2,"a",6),e.qZA()(),e.TgZ(13,"c-tab-content",null,7)(15,"c-tab-pane",8)(16,"div",9)(17,"h1"),e._uU(18,"Services"),e.qZA()(),e.YNc(19,Re,26,5,"div",10),e.qZA(),e.TgZ(20,"c-tab-pane",8)(21,"div",9)(22,"h1"),e._uU(23,"Custom Items"),e.qZA()(),e.YNc(24,$e,21,4,"div",10),e.TgZ(25,"div",11)(26,"div",12)(27,"div",13)(28,"label"),e._uU(29,"Custom Items Total Price"),e.qZA(),e._UZ(30,"input",14),e.qZA()()()(),e.TgZ(31,"c-tab-pane",8)(32,"div",9)(33,"h1"),e._uU(34,"Medicines"),e.qZA()(),e.YNc(35,We,26,5,"div",10),e.qZA(),e.TgZ(36,"c-tab-pane",8)(37,"div",9)(38,"h1"),e._uU(39,"Invoice Totals"),e.qZA()(),e.TgZ(40,"div",11)(41,"div",12)(42,"div",13)(43,"label"),e._uU(44,"Appointment Type Price"),e.qZA(),e._UZ(45,"input",14),e.qZA()(),e.TgZ(46,"div",12)(47,"div",13)(48,"label"),e._uU(49,"Total Due"),e.qZA(),e._UZ(50,"input",14),e.qZA()(),e.TgZ(51,"div",12)(52,"div",13)(53,"label"),e._uU(54,"Discount Percentage"),e.qZA(),e._UZ(55,"input",14),e.qZA()()(),e.TgZ(56,"div",11)(57,"div",12)(58,"div",13)(59,"label"),e._uU(60,"Total After Discount"),e.qZA(),e._UZ(61,"input",14),e.qZA()(),e.TgZ(62,"div",12)(63,"div",13)(64,"label"),e._uU(65,"Total Paid"),e.qZA(),e.TgZ(66,"input",15),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.totalPaid=i)}),e.qZA()()(),e.TgZ(67,"div",12)(68,"div",13)(69,"label"),e._uU(70,"Total Remaning"),e.qZA(),e.TgZ(71,"input",16),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.totalRemaining=i)}),e.qZA()()()(),e.TgZ(72,"div",11)(73,"div",12)(74,"div",13)(75,"label"),e._uU(76,"Finalization Date"),e.qZA(),e._UZ(77,"input",14),e.ALo(78,"date"),e.qZA()(),e.TgZ(79,"div",12)(80,"div",13)(81,"label"),e._uU(82,"Payment Method"),e.qZA(),e._UZ(83,"input",14),e.qZA()()(),e.TgZ(84,"button",17),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.updateTotalPaid())}),e._uU(85," Update Total Paid "),e.qZA()()(),e._UZ(86,"app-prescription",18),e.BQk()}if(2&o){const n=e.MAs(14),t=e.oxw();e.xp6(3),e.Q6J("active",!0)("cTabContent",n)("tabPaneIdx",0),e.xp6(3),e.Q6J("cTabContent",n)("tabPaneIdx",1),e.xp6(3),e.Q6J("cTabContent",n)("tabPaneIdx",2),e.xp6(3),e.Q6J("ngIf",!t.isDoctor()),e.xp6(7),e.Q6J("ngForOf",t.invoice.invoiceDoctorServices),e.xp6(5),e.Q6J("ngForOf",t.invoice.customItems),e.xp6(6),e.s9C("value",t.invoice.customItemsTotalPrice),e.xp6(5),e.Q6J("ngForOf",t.invoice.invoiceMedicines),e.xp6(10),e.s9C("value",t.invoice.appointmentTypePrice),e.xp6(5),e.s9C("value",t.invoice.totalDue),e.xp6(5),e.MGl("value","",t.invoice.discountPercentage,"%"),e.xp6(6),e.s9C("value",t.invoice.totalAfterDiscount),e.xp6(5),e.s9C("value",t.invoice.totalPaid),e.Q6J("ngModel",t.totalPaid),e.xp6(5),e.Q6J("ngModel",t.totalRemaining),e.xp6(6),e.s9C("value",e.xi3(78,22,t.invoice.finalizationDate,"short")),e.xp6(6),e.s9C("value",t.invoice.paymentMethod),e.xp6(3),e.Q6J("invoice",t.invoice)}}let Xe=(()=>{var o;class s{constructor(t,i,r,c){this.route=t,this.accountService=i,this.invoiceService=r,this.toastr=c,this.totalPaid=0,this.totalRemaining=0}ngOnInit(){this.route.data.subscribe(t=>{this.invoice=t.invoice,this.totalPaid=this.invoice?.totalPaid||0,this.totalRemaining=this.invoice?.totalRemaining||0,this.accountService.currentUser$.pipe((0,C.q)(1)).subscribe(i=>this.currentUser=i)})}isDoctor(){return this.currentUser?.roles.includes(T.K.DOCTOR)}updateTotalPaid(){this.invoiceService.updateInvoiceDebt(this.invoice?.id,this.totalPaid).subscribe(t=>{this.totalRemaining=t,this.toastr.success("Debt Updated Successfully")})}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(A.gz),e.Y36(m.B),e.Y36(P),e.Y36(O._W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-invoice-appointment"]],decls:4,vars:2,consts:[[4,"ngIf"],[1,"w-100","text-center"],["type","button","printSectionId","prescription","ngxPrint","",1,"btn","btn-primary",3,"useExistingCss"],["variant","tabs"],["cNavLink","",3,"active","cTabContent","tabPaneIdx"],["cNavLink","",3,"cTabContent","tabPaneIdx"],["cNavLink","",3,"cTabContent","tabPaneIdx",4,"ngIf"],["tabContent","cTabContent"],[1,"p-3"],[1,"text-center","mb-3"],["class","row",4,"ngFor","ngForOf"],[1,"row"],[1,"col"],[1,"mb-3"],["disabled","",1,"form-control",3,"value"],["type","number",1,"form-control",3,"ngModel","value","ngModelChange"],["disabled","",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary",3,"click"],[3,"invoice"]],template:function(t,i){1&t&&(e.YNc(0,je,87,25,"ng-container",0),e.TgZ(1,"div",1)(2,"button",2),e._uU(3," Print Prescription "),e.qZA()()),2&t&&(e.Q6J("ngIf",i.invoice),e.xp6(2),e.Q6J("useExistingCss",!0))},dependencies:[v.sg,v.O5,a.Fj,a.wV,a.JJ,a.On,u.rZi,u.HOP,u.Vh3,u.C$2,u.Eug,u.hL0,Ke,Ge,v.uU]}),s})();const R=(o,s)=>(0,e.f3M)(P).getInvoice(parseInt(o.paramMap.get("invoiceId")));function et(o,s){1&o&&(e.TgZ(0,"div",17)(1,"div",18)(2,"div",3),e._UZ(3,"app-text-input",19),e.qZA(),e.TgZ(4,"div",3),e._UZ(5,"app-text-input",20),e.qZA(),e.TgZ(6,"div",3),e._UZ(7,"app-text-input",21),e.qZA(),e.TgZ(8,"div",3),e._UZ(9,"app-text-input",22),e.qZA(),e.TgZ(10,"div",3),e._UZ(11,"app-text-input",23),e.qZA()()()),2&o&&e.Q6J("formGroupName",s.index)}function tt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",17)(1,"div",2)(2,"div",3)(3,"label"),e._uU(4,"Service Name"),e.qZA(),e._UZ(5,"app-text-input",24),e.qZA(),e.TgZ(6,"div",3)(7,"label"),e._uU(8,"Service Price"),e.qZA(),e._UZ(9,"app-text-input",25),e.qZA(),e.TgZ(10,"div",3)(11,"label"),e._uU(12,"Quantity"),e.qZA(),e.TgZ(13,"app-text-input",26),e.NdJ("change",function(){const r=e.CHM(n).index,c=e.oxw(2);return e.KtG(c.quantityChanged(r))}),e.qZA()(),e.TgZ(14,"div",3)(15,"label"),e._uU(16,"Service Total Price"),e.qZA(),e._UZ(17,"app-text-input",27),e.qZA()()()}2&o&&e.Q6J("formGroupName",s.index)}function it(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"div",17)(1,"div",2)(2,"div",3)(3,"label"),e._uU(4,"Item Name"),e.qZA(),e._UZ(5,"app-text-input",28),e.qZA(),e.TgZ(6,"div",3)(7,"label"),e._uU(8,"Item Price"),e.qZA(),e._UZ(9,"app-text-input",29),e.qZA(),e.TgZ(10,"div",3)(11,"label"),e._uU(12,"Units"),e.qZA(),e._UZ(13,"app-text-input",30),e.qZA(),e.TgZ(14,"div",31)(15,"div",32)(16,"label"),e._uU(17,"Remove"),e.qZA(),e.TgZ(18,"button",33),e.NdJ("click",function(){const r=e.CHM(n).index,c=e.oxw(2);return e.KtG(c.removeCustomItem(r))}),e.O4$(),e._UZ(19,"svg",34),e.qZA()()()()()}2&o&&e.Q6J("formGroupName",s.index)}function nt(o,s){if(1&o&&(e.TgZ(0,"li"),e._uU(1),e.qZA()),2&o){const n=s.$implicit;e.xp6(1),e.hij(" ",n," ")}}function ot(o,s){if(1&o&&(e.TgZ(0,"div",2)(1,"ul",35),e.YNc(2,nt,2,1,"li",36),e.qZA()()),2&o){const n=e.oxw(2);e.xp6(2),e.Q6J("ngForOf",n.validationErrors)}}const $=function(){return{standalone:!0}};function rt(o,s){if(1&o){const n=e.EpF();e.TgZ(0,"form",1),e.NdJ("ngSubmit",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.createInvoiceForm.valid&&i.createInvoice())}),e.TgZ(1,"div",2)(2,"div",3)(3,"div",4)(4,"label",5),e._uU(5,"Medicine"),e.qZA(),e.TgZ(6,"ng-select",6),e.NdJ("search",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.searchMedicines(i))})("change",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onMedicineSelect(i))})("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedMedicines=i)}),e.qZA()()()(),e.TgZ(7,"div",7),e.YNc(8,et,12,1,"div",8),e.qZA(),e.TgZ(9,"div",2)(10,"div",3)(11,"div",4)(12,"label",5),e._uU(13,"Select Services"),e.qZA(),e.TgZ(14,"ng-select",9),e.NdJ("ngModelChange",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.selectedServices=i)})("change",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.onServiceSelect(i))})("remove",function(i){e.CHM(n);const r=e.oxw();return e.KtG(r.invoiceRemoveService(i))}),e.qZA()()()(),e.TgZ(15,"div",10),e.YNc(16,tt,18,1,"div",8),e.qZA(),e.TgZ(17,"div",11)(18,"div",12)(19,"button",13),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.pushNewCustomItem())}),e._uU(20,"Add A Custom Item"),e.qZA()()(),e.TgZ(21,"div",14),e.YNc(22,it,20,1,"div",8),e.qZA(),e.TgZ(23,"div",11)(24,"div",12)(25,"button",15),e._uU(26,"Create Invoice"),e.qZA()()(),e.YNc(27,ot,3,1,"div",16),e.qZA()}if(2&o){const n=e.oxw();e.Q6J("formGroup",n.createInvoiceForm),e.xp6(6),e.Q6J("items",n.medicineList)("virtualScroll",!0)("bindLabel","name")("bindValue","id")("multiple",!0)("ngModel",n.selectedMedicines)("ngModelOptions",e.DdM(21,$))("compareWith",n.compareFn),e.xp6(2),e.Q6J("ngForOf",n.createInvoiceForm.controls.invoiceMedicines.controls),e.xp6(6),e.Q6J("ngModel",n.selectedServices)("items",n.services)("virtualScroll",!0)("multiple",!0)("bindLabel","name")("ngModelOptions",e.DdM(22,$))("clearable",!1),e.xp6(2),e.Q6J("ngForOf",n.createInvoiceForm.controls.invoiceSelectedServices.controls),e.xp6(6),e.Q6J("ngForOf",n.createInvoiceForm.controls.customItems.controls),e.xp6(3),e.Q6J("disabled",!n.createInvoiceForm.valid),e.xp6(2),e.Q6J("ngIf",n.validationErrors.length>0)}}const at=[{path:"",component:ne,data:{title:"Appointments"}},{path:"add",component:ve,data:{title:"Add Appointment"}},{path:"update/:id",component:Me,resolve:{appointment:Y},data:{title:"Update Appointment"}},{path:"finalize/:invoiceId",component:He,resolve:{invoice:R}},{path:"medical-operations/:id",component:(()=>{var o;class s{constructor(t,i,r,c,l,d,g){this.fb=t,this.route=i,this.doctorServiceService=r,this.serviceService=c,this.invoiceService=l,this.router=d,this.medicineService=g,this.doctor_services=[],this.services=[],this.selectedServices=[],this.validationErrors=[],this.medicineList=[],this.selectedMedicines=[],this.medicineParams={pageNumber:1,pageSize:5}}ngOnInit(){this.route.data.subscribe(t=>{this.appointment=t.appointment,this.getDoctorServicesByDoctorId(),this.initializeForm()})}compareFn(t,i){return t&&i?t.id===i.id:t===i}searchMedicines(t){t.term.trim().length>1&&(this.medicineParams.searchTerm=t.term,this.medicineService.getMedicines(this.medicineParams).subscribe(i=>{this.medicineList=i.result}))}onMedicineSelect(t){this.updateSelectedMedicineItems(t)}updateSelectedMedicineItems(t){this.removeUnselectedMedicineItems(t),this.addNewMedicineItems(t)}removeUnselectedMedicineItems(t){const i=this.createInvoiceForm.get("invoiceMedicines");for(let r=i.length-1;r>=0;r--){const c=i.at(r).get("medicineId")?.value;t.some(l=>l.id===c)||i.removeAt(r)}}addNewMedicineItems(t){const i=this.createInvoiceForm.get("invoiceMedicines");t.forEach(r=>{i.controls.find(l=>l.get("medicineId")?.value===r.id)||i.push(this.fb.group({medicineName:[{value:r.name,disabled:!0}],medicineId:[r.id],dosageAmount:[""==r.dosageAmount?"":r.dosageAmount,a.kI.required],duration:[""==r.duration?"":r.duration,a.kI.required],frequency:[""==r.frequency?"":r.frequency,a.kI.required],note:[""==r.note?"":r.note]}))})}getDoctorServicesByDoctorId(){this.doctorServiceService.getDoctorServiceByDocorId(this.appointment.doctorId.toString()).subscribe(t=>{this.doctor_services=t,this.services=this.doctor_services.map(i=>i.service)})}initializeForm(){this.createInvoiceForm=this.fb.group({invoiceSelectedServices:this.fb.array([]),customItems:this.fb.array([]),invoiceMedicines:this.fb.array([])})}pushNewCustomItem(){this.createInvoiceForm.get("customItems").push(this.fb.group({name:["",a.kI.required],price:[1,[a.kI.required,a.kI.min(1)]],units:[1,[a.kI.required,a.kI.min(1)]]}))}removeCustomItem(t){this.createInvoiceForm.get("customItems").removeAt(t)}onServiceSelect(t){this.updateSelectedService(t)}invoiceRemoveService(t){const i=this.createInvoiceForm.get("invoiceSelectedServices"),r=i.controls.findIndex(c=>c.get("serviceId")?.value===t.value.id);-1!==r&&i.removeAt(r)}updateSelectedService(t){const i=this.createInvoiceForm.get("invoiceSelectedServices");t.forEach(r=>{const c=r.id;i.controls.some(d=>d.get("serviceId")?.value===c)||this.getServiceDisposablePrice(c,1).subscribe(d=>{i.push(this.fb.group({serviceName:[{value:r.name,disabled:!0},a.kI.required],servicePrice:[{value:r.totalPrice,disabled:!0},a.kI.required],quantity:[1,[a.kI.required,a.kI.min(1)]],serviceId:[r.id,a.kI.required],servicetotalPrice:[{value:r.totalPrice+d,disabled:!0},a.kI.required],serviceDisposablePrice:[d]}))})})}getServiceDisposablePrice(t,i){return this.serviceService.getServiceDispsablesPrice(t,i)}quantityChanged(t){const r=this.createInvoiceForm.get("invoiceSelectedServices").at(t);var c=r.getRawValue().quantity;if(!(c<=0)){var l=r.getRawValue().serviceId,d=r.getRawValue().servicePrice;this.getServiceDisposablePrice(l,c).subscribe({next:g=>{r.get("disposablesPrice")?.setValue(g);var _=d*c+g;r.get("servicetotalPrice")?.setValue(_)},error:g=>{r.get("quantity")?.setValue(1)}})}}mapInvoiceFormToCreateInvoice(){return{id:0,appointmentId:this.appointment?.id,paymentMethod:"cash",discountPercentage:0,totalPaid:0,invoiceDoctorServices:this.mapCreateDoctorService(),customItems:this.createInvoiceForm.get("customItems")?.value,invoiceMedicines:this.createInvoiceForm.get("invoiceMedicines")?.value}}createInvoice(){var t=this.mapInvoiceFormToCreateInvoice();this.invoiceService.createInvoice(t).subscribe(i=>{this.router.navigate(["appointments/view-invoice/"+i.id])})}mapCreateDoctorService(){const t=[];return this.createInvoiceForm.get("invoiceSelectedServices").controls.forEach(r=>{const c={doctorServiceId:this.doctor_services?.find(l=>l.serviceId==r.get("serviceId")?.value)?.id,serviceQuantity:r.get("quantity")?.value};t.push(c)}),t}}return(o=s).\u0275fac=function(t){return new(t||o)(e.Y36(a.qu),e.Y36(A.gz),e.Y36(H.M),e.Y36(K.m),e.Y36(P),e.Y36(A.F0),e.Y36(B.A))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-medical-operations"]],decls:1,vars:1,consts:[["cForm","","autocomplete","off",3,"formGroup","ngSubmit",4,"ngIf"],["cForm","","autocomplete","off",3,"formGroup","ngSubmit"],[1,"row"],[1,"col"],[1,"mb-3"],["cLabel",""],[3,"items","virtualScroll","bindLabel","bindValue","multiple","ngModel","ngModelOptions","compareWith","search","change","ngModelChange"],["formArrayName","invoiceMedicines",1,"mb-3"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"ngModel","items","virtualScroll","multiple","bindLabel","ngModelOptions","clearable","ngModelChange","change","remove"],["formArrayName","invoiceSelectedServices",1,"mb-3"],[1,"row","mb-3","d-flex","justify-content-center"],[1,"col-6","text-center"],["cButton","","color","success",3,"click"],["formArrayName","customItems",1,"mb-3"],["cButton","","color","primary","type","submit",3,"disabled"],["class","row",4,"ngIf"],[3,"formGroupName"],[1,"row","mb-3"],["formControlName","medicineName","label","Medicine Name"],["formControlName","dosageAmount","label","Dosage Amount"],["formControlName","duration","label","Duration"],["formControlName","frequency","label","Frequency"],["formControlName","note","label","Note"],["formControlName","serviceName","label","Service Name"],["formControlName","servicePrice","label","Service Price"],["type","number","formControlName","quantity","label","Quantity",3,"change"],["type","number","formControlName","servicetotalPrice","label","Service Total Price"],["formControlName","name","label","Item Name"],["type","number","formControlName","price","label","Item Price"],["type","number","formControlName","units","label","Units"],[1,"col-1"],[1,"d-flex","flex-column"],["cButton","","color","danger",1,"btn-m",3,"click"],["cIcon","","name","cil-trash"],[1,"text-danger"],[4,"ngFor","ngForOf"]],template:function(t,i){1&t&&e.YNc(0,rt,28,23,"form",0),2&t&&e.Q6J("ngIf",i.doctor_services)},dependencies:[v.sg,v.O5,a._Y,a.JJ,a.JL,a.On,G.t,h.ar,u.Hq3,u.$_X,u.eFW,a.sg,a.u,a.x0,a.CE,D.w9]}),s})(),resolve:{appointment:Y},data:{title:"Enter Medical Operations"}},{path:"view-invoice/:invoiceId",component:Xe,resolve:{invoice:R},data:{title:"Invoice Details"}}];let st=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[A.Bz.forChild(at),A.Bz]}),s})(),ct=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[v.uU],imports:[st,u.U$I,u.W4s,u.e$z,v.ez,a.u5,I.c,u.m81,u.zkK,D.A0,ze]}),s})()},7490:(w,y,p)=>{p.d(y,{M:()=>v});var u=p(2557);class v extends u.Z{constructor(I){super(),this.orderBy="date",this.order="asc",this.gender="",this.searchTerm="",this.roleName="",this.doctorSpecialityId=null,Object.assign(this,I)}}}}]);